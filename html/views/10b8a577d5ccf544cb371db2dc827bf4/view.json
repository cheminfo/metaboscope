{"version":"2.146.0","grid":{"layers":{"Default layer":{"name":"Default layer"},"Admin":{"name":"Admin"},"preferences":{"name":"preferences"},"import data":{"name":"import data"},"results":{"name":"results"},"create":{"name":"create"},"Load and Process":{"name":"Load and Process"}},"xWidth":10,"yHeight":10},"modules":[{"url":"modules/types/client_interaction/dragdrop/","configuration":{"sections":{},"groups":{"group":[{"label":["Drop your SDF file here"],"dragoverlabel":[null],"hoverlabel":["Drag'n drop or paste here"],"fileSelectLabel":["Select file"],"labelFontSize":[26],"checkOptions":[["promptAmbiguous"]],"inputOptions":[["allowDrop","allowPaste","allowFileInput"]]}],"vars":[[{"filter":"ext","extension":"*","filetype":"text","type":"","variable":"file"}]],"string_general":[{"askFilename":[[]]}],"string":[[{"filter":"ext","extension":"*","type":"","variable":"str"}]],"photo":[[{"variable":"photo"}]]}},"layers":{"Default layer":{"position":{"left":0,"top":68},"size":{"width":39,"height":10},"zIndex":0,"display":true,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Admin":{"position":{"left":0,"top":8},"size":{"width":36,"height":10},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"preferences":{"position":{"left":0,"top":8},"size":{"width":36,"height":10},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"import data":{"position":{"left":0,"top":8},"size":{"width":36,"height":10},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"results":{"position":{"left":0,"top":8},"size":{"width":36,"height":10},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"create":{"position":{"left":0,"top":76},"size":{"width":36,"height":10},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Load and Process":{"position":{"left":0,"top":68},"size":{"width":39,"height":10},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"}},"id":77,"vars_out":[{"event":"onRead","rel":"dataarray","jpath":[],"name":"dropped"}],"vars_in":[],"actions_in":[{}],"actions_out":[{"jpath":[]}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[[]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"","zindex":2},{"url":"modules/types/client_interaction/code_executor/","configuration":{"sections":{},"groups":{"group":[{"display":[["editor","buttons"]],"execOnLoad":[[]],"asyncAwait":[["top"]],"script":["const cdb = new CDB();\nif(this.variable === 'dropped') {\n    let data = API.getData('dropped');\n    const parserResult = SDFileParser(data.file[0].content);\n    let id = 1;\n    parserResult.molecules.forEach( (e) => {\n        e.id=id++;\n        e._highlight=id;\n    });\n    parserResult.labels.push('id');\n    API.createData('molfiles', parserResult.molecules);\n} else if (this.button === 'load') {\n    const data = await cdb.get('upload/dataset.sdf');\n    const parserResult = SDFileParser(data + '');\n    let id = 1;\n    parserResult.molecules.forEach( (e) => {\n        e.id=id++;\n        e._highlight=id;\n    });\n    parserResult.labels.push('id');\n    API.createData('molfiles', parserResult.molecules);\n}\n\n"]}],"libs":[[{"lib":"src/util/couchdbAttachments","alias":"CDB"},{"lib":"https://www.lactame.com/lib/sdf-parser/3.1.0/sdf-parser.js","alias":"SDFileParser"}]],"buttons":[[{"name":"load","label":"Load demo","hide":[],"disable":[]}]]}},"layers":{"Default layer":{"position":{"left":125,"top":1},"size":{"width":24,"height":4},"zIndex":0,"display":true,"title":"Import data","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"Default layer"},"Admin":{"position":{"left":0,"top":60},"size":{"width":56,"height":28},"zIndex":0,"display":true,"title":"Import data","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"preferences":{"position":{"left":37,"top":0},"size":{"width":24,"height":4},"zIndex":0,"display":false,"title":"Import data","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"import data":{"position":{"left":0,"top":6},"size":{"width":50,"height":42},"zIndex":0,"display":false,"title":"Import data","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"results":{"position":{"left":0,"top":105},"size":{"width":52,"height":61},"zIndex":0,"display":false,"title":"Import data","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"create":{"position":{"left":125,"top":1},"size":{"width":24,"height":4},"zIndex":0,"display":false,"title":"Import data","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"Default layer"},"Load and Process":{"position":{"left":125,"top":1},"size":{"width":24,"height":4},"zIndex":0,"display":false,"title":"Import data","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"Default layer"}},"id":78,"vars_in":[{"rel":"inputValue","name":"dropped"}],"actions_in":[{}],"vars_out":[{"jpath":[]}],"actions_out":[{"jpath":[]}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[["Open Preferences"]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"Import data","zindex":2},{"url":"modules/types/edition/slick_grid/","configuration":{"sections":{},"groups":{"group":[{"slickCheck":[["enableCellNavigation","rowNumbering","forceFitColumns","highlightScroll","filterColumns","editable","forgetLastActive"]],"copyPaste":[[]],"copyPasteOptions":[["newRows"]],"autoColumns":[["remove"]],"toolbar":[[]],"colorjpath":[["bgcolor"]],"slick.defaultColumnWidth":[null],"slick.rowHeight":["70"],"slick.headerRowHeight":[30],"slick.selectionModel":["row"],"idProperty":[""],"filterType":["pref"],"filterRow":["if (this.event==='rowsChanged') {\n    let dataset = API.getData('dataset');\n    let rows = this.rows;\n    for (let i = 0; i < rows.length; i++) {\n        let index = dataset.samples.findIndex((row) => row.id == rows[i].id);\n        rows[i].item.bgcolor = index !== -1 ? '#98F274' : undefined;\n    }\n    rerender();\n}\n"],"customJpaths":[""]}],"cols":[[{"name":"Molfile","jpath":["molfile"],"forceType":"mol2d","width":150,"minWidth":150,"maxWidth":150,"editor":"none","formatter":"typerenderer","selectable":[],"resizable":[],"sortable":[],"focusable":[],"defaultSortAsc":[]},{"name":"id","jpath":["id"],"forceType":"string","editor":"string","formatter":"typerenderer","width":"","minWidth":"","maxWidth":"","selectable":[],"resizable":[],"sortable":[],"focusable":[],"defaultSortAsc":[]},{"name":"label","jpath":["label"],"forceType":"string","editor":"string","formatter":"typerenderer","width":"","minWidth":"","maxWidth":"","selectable":[],"resizable":[],"sortable":[],"focusable":[],"defaultSortAsc":[]},{"name":"MF","jpath":["MF"],"forceType":"string","editor":"string","formatter":"typerenderer","width":"","minWidth":"","maxWidth":"","selectable":[],"resizable":[],"sortable":[],"focusable":[],"defaultSortAsc":[]}]],"actionCols":[[{"name":"...","tooltip":"Add molfile","icon":"fa-plus","backgroundColor":[255,255,255,0],"color":[0,0,0,1],"action":"addMolecule","position":"end","clickMode":"text","isAction":true}]],"groupings":[[{"getter":[]}]],"actionOutButtons":[[{}]],"data":[{"saveInView":[[]],"varname":[""],"data":["[]"]}]}},"layers":{"Default layer":{"position":{"left":0,"top":6},"size":{"width":39,"height":61},"zIndex":0,"display":true,"title":"Select molecules to be part of dataset","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Admin":{"position":{"left":0,"top":19},"size":{"width":36,"height":69},"zIndex":0,"display":false,"title":"Select molecules to be part of dataset","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"preferences":{"position":{"left":0,"top":19},"size":{"width":36,"height":69},"zIndex":0,"display":false,"title":"Select molecules to be part of dataset","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"import data":{"position":{"left":0,"top":19},"size":{"width":36,"height":69},"zIndex":0,"display":false,"title":"Select molecules to be part of dataset","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"results":{"position":{"left":0,"top":19},"size":{"width":36,"height":69},"zIndex":0,"display":false,"title":"Select molecules to be part of dataset","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"create":{"position":{"left":0,"top":6},"size":{"width":36,"height":69},"zIndex":0,"display":false,"title":"Select molecules to be part of dataset","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Load and Process":{"position":{"left":0,"top":6},"size":{"width":39,"height":61},"zIndex":0,"display":false,"title":"Select molecules to be part of dataset","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"}},"id":79,"vars_in":[{"rel":"list","name":"molfiles"}],"actions_in":[{"rel":"scrollToRow","name":"RerenderSelected"},{"rel":"_editPreferences","name":"setLabels"},{"rel":"rerender","name":"renderGrid"}],"actions_out":[{"event":"onRowsSelect","rel":"rows","jpath":[],"name":"clickedSample"}],"vars_out":[{"event":"onRowsSelect","rel":"rows","jpath":[],"name":"selectedMolfiles"},{"event":"onRowActive","rel":"row","jpath":[],"name":"activatedMolfile"}],"toolbar":{"custom":[[{"title":"Load molecules","icon":"fa fa-download","action":"saveSdf","position":"begin","color":[7,55,99,1]},{"title":"Add all molfiles","icon":"fas fa-plus-circle","action":"addAllMolecules","position":"begin","color":[56,118,29,1]},{"title":"Add molfiles","icon":"fa-plus","action":"addMolecules","position":"begin","color":[56,118,29,1]},{"title":"Add selected molfiles","icon":"fa-bullseye","action":"addSelectedMolecules","position":"begin","color":[191,144,0,1]},{"title":"Remove molfiles","icon":"fa-minus","action":"removeMolecules","position":"begin","color":[152,0,0,1]},{"title":"Remove all molfiles","icon":"fas fa-minus-circle","action":"removeAllMolecules","position":"begin","color":[152,0,0,1]}]],"common":[{"toolbar":[[]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"Select molecules to be part of dataset","zindex":2},{"url":"modules/types/client_interaction/code_executor/","configuration":{"sections":{},"groups":{"group":[{"display":[["editor","buttons"]],"execOnLoad":[[]],"asyncAwait":[["top"]],"script":["let molfiles = API.getData('molfiles');\nlet selectedMolfiles = API.getData('selectedMolfiles');\nlet dataset = API.getData('dataset');\nlet preferences = API.getData('preferences').resurrect();\n\nconsole.log('Received action:', this.action)\nif (this.action) {\n    switch (this.action.name) {\n        case 'addAllMolecules': {\n            for (let molfile of molfiles) {\n                addMolfile(molfile)\n            };\n            break\n        }\n        case 'addMolecules': {\n            for (let molfile of selectedMolfiles) {\n                addMolfile(molfile)\n            };\n            break\n        }\n        case 'addSelectedMolecules': {\n            dataset.samples = [];\n            for (let molfile of selectedMolfiles) {\n                addMolfile(molfile)\n            };\n            break\n        }\n        case 'removeMolecules': {\n            for (let molfile of selectedMolfiles) {\n                removeMolfile(molfile)\n            };\n            break\n        }\n        case 'removeAllMolecules': {\n            dataset.samples = [];\n            break\n        }\n        case 'addMolecule': {\n            addMolfile(this.action.value);\n            break\n        }\n        case 'removeMolecule': {\n            removeMolfile(this.action.value);\n            break\n        }\n    }\n}\n\n\nfunction addMolfile(molfile) {\n    const index = dataset.samples\n        .find((element) => element.id == DataObject.resurrect(molfile.id))\n    if (index) return;\n    dataset.samples.push({\n        id: molfile.id,\n        name: molfile.Name,\n        isBiomarker: false,\n        molfile: molfile.molfile,\n        _highlight: molfile._highlight,\n    })\n};\n\nfunction removeMolfile(molfile) {\n    const index = dataset.samples\n        .findIndex((element) => element.id == DataObject.resurrect(molfile.id)) + 1;\n    if (!index) return;\n    dataset.samples.splice(index - 1, 1)\n}\n\nconst stdMin = parseFloat(preferences.dataset.std.min);\nconst stdMax = parseFloat(preferences.dataset.std.max);\nconst meanMin = parseFloat(preferences.dataset.mean.min);\nconst meanMax = parseFloat(preferences.dataset.mean.max);\n\ndataset.samples.map((item) => item.parameters = {\n    mean: meanMin + (Math.random() * (meanMax - meanMin)),\n    standardDeviation: stdMin + (Math.random() * (stdMax - stdMin))\n})\n\nif (API.getData('molfiles')) molfiles.triggerChange();\nAPI.createData('datasetSamples', dataset.samples)\n"]}],"libs":[[{}]],"buttons":[[{"name":"button1","label":"Execute","hide":[],"disable":[]}]]}},"layers":{"Default layer":{"position":{"left":0,"top":89},"size":{"width":56,"height":80},"zIndex":0,"display":false,"title":"Actions manager","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Admin":{"position":{"left":110,"top":0},"size":{"width":56,"height":62},"zIndex":0,"display":true,"title":"Actions manager","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"preferences":{"position":{"left":0,"top":89},"size":{"width":56,"height":80},"zIndex":0,"display":false,"title":"Actions manager","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"import data":{"position":{"left":0,"top":89},"size":{"width":56,"height":80},"zIndex":0,"display":false,"title":"Actions manager","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"results":{"position":{"left":0,"top":89},"size":{"width":56,"height":80},"zIndex":0,"display":false,"title":"Actions manager","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"create":{"position":{"left":0,"top":89},"size":{"width":56,"height":80},"zIndex":0,"display":false,"title":"Actions manager","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Load and Process":{"position":{"left":0,"top":89},"size":{"width":56,"height":80},"zIndex":0,"display":false,"title":"Actions manager","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"}},"id":80,"vars_in":[{"rel":"inputValue","name":"preferences"}],"actions_in":[{"rel":"execute","name":"addAllMolecules"},{"rel":"execute","name":"addMolecules"},{"rel":"execute","name":"addSelectedMolecules"},{"rel":"execute","name":"removeMolecules"},{"rel":"execute","name":"removeAllMolecules"},{"rel":"execute","name":"addMolecule"},{"rel":"execute","name":"removeMolecule"}],"vars_out":[{"jpath":[]}],"actions_out":[{"jpath":[]}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[["Open Preferences"]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"Actions manager","zindex":2},{"url":"modules/types/edition/slick_grid/","configuration":{"sections":{},"groups":{"group":[{"slickCheck":[["enableCellNavigation","rowNumbering","forceFitColumns","highlightScroll","forgetLastActive","editable"]],"copyPaste":[[]],"copyPasteOptions":[["newRows"]],"autoColumns":[[]],"toolbar":[[]],"colorjpath":[[]],"slick.defaultColumnWidth":[null],"slick.rowHeight":["70"],"slick.headerRowHeight":[30],"slick.selectionModel":["row"],"idProperty":[""],"filterType":["pref"],"filterRow":["// Documentation: https://github.com/NPellet/visualizer/blob/46b40ca86345f8fa313563bf9c6ecb80ba323101/src/modules/types/edition/slick_grid/view.js#L1695-L1735"],"customJpaths":[""]}],"cols":[[{"name":"ID","jpath":["id"],"editor":"none","forceType":"","formatter":"typerenderer","copyFormatter":"default","visibility":"both","rendererOptions":"","editorOptions":"","width":104,"hideColumn":[]},{"name":"Molecule","jpath":["molfile"],"editor":"none","forceType":"mol2d","formatter":"typerenderer","copyFormatter":"default","visibility":"both","rendererOptions":"","editorOptions":"","width":146,"hideColumn":[]},{"name":"Mean","jpath":["parameters","mean"],"editor":"none","forceType":"","formatter":"typerenderer","copyFormatter":"default","visibility":"both","rendererOptions":"toPrecision: 3","editorOptions":"","width":70,"hideColumn":[]},{"name":"Std","jpath":["parameters","standardDeviation"],"editor":"none","forceType":"","formatter":"typerenderer","copyFormatter":"default","visibility":"both","rendererOptions":"toPrecision: 3","editorOptions":"","hideColumn":[]},{"name":"Biormarker","jpath":["isBiomarker"],"editor":"boolean","forceType":"boolean","formatter":"typerenderer","copyFormatter":"default","visibility":"both","rendererOptions":"","editorOptions":"","width":67,"hideColumn":[]}]],"actionCols":[[{"name":"...","tooltip":"Remove molfile","icon":"fa-minus","backgroundColor":[255,255,255,0],"color":[0,0,0,1],"action":"removeMolecule","position":"end","clickMode":"text","isAction":true}]],"groupings":[[{"getter":[]}]],"actionOutButtons":[[{}]],"data":[{"saveInView":[[]],"varname":[""],"data":["[]"]}]}},"layers":{"Default layer":{"position":{"left":40,"top":21},"size":{"width":48,"height":57},"zIndex":0,"display":true,"title":"Selected chemical structures","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Admin":{"position":{"left":37,"top":8},"size":{"width":41,"height":80},"zIndex":0,"display":false,"title":"Selected chemical structures","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"preferences":{"position":{"left":37,"top":8},"size":{"width":41,"height":80},"zIndex":0,"display":false,"title":"Selected chemical structures","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"import data":{"position":{"left":37,"top":8},"size":{"width":41,"height":80},"zIndex":0,"display":false,"title":"Selected chemical structures","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"results":{"position":{"left":37,"top":8},"size":{"width":41,"height":80},"zIndex":0,"display":false,"title":"Selected chemical structures","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"create":{"position":{"left":37,"top":20},"size":{"width":48,"height":66},"zIndex":0,"display":false,"title":"Selected chemical structures","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Load and Process":{"position":{"left":40,"top":21},"size":{"width":48,"height":57},"zIndex":0,"display":false,"title":"Selected chemical structures","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"}},"id":81,"vars_in":[{"rel":"list","name":"datasetSamples"}],"actions_in":[{}],"vars_out":[{"jpath":[]}],"actions_out":[{"jpath":[]}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[[]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"Selected chemical structures","zindex":19},{"url":"modules/types/client_interaction/code_executor/","configuration":{"sections":{},"groups":{"group":[{"display":[["editor","buttons"]],"execOnLoad":[[]],"asyncAwait":[["top"]],"script":["let preferences = API.getData('preferences').resurrect();\nlet datasetSamples = API.getData('datasetSamples');\nif (!datasetSamples) return;\n\nlet configurationFile = {\n    seed: preferences.seed,\n    noiseFactor: preferences.noiseFactor,\n    nbPoints: preferences.nbPoints,\n    classes: new Array(parseInt(preferences.nbClasses))\n}\n\nfor (let i = 0; i < preferences.nbClasses; i++) {\n    configurationFile.classes[i] =  { nbSpectra: 1 };\n    configurationFile.classes[i].unitParameters = [];\n    for (let sample of datasetSamples) {\n        if (DataObject.resurrect(sample.isBiomarker) == true) {\n            configurationFile.classes[i].unitParameters.push({\n                isBiomarker: sample.isBiomarker,\n                index: sample.id,\n                molfile: sample.molfile\n            })\n        } else {\n            configurationFile.classes[i].unitParameters.push({\n                isBiomarker: sample.isBiomarker,\n                index: sample.id,\n                molfile: sample.molfile,\n                distribution: {\n                    name: \"normal\",\n                    parameters: sample.parameters\n                },\n            })    \n        }\n    }\n}\n\nawait API.createData('configurationFile', configurationFile);\nAPI.doAction('updateTwig', '')\nconfigurationFile.triggerChange()\n\n"]}],"libs":[[{}]],"buttons":[[{"name":"button1","label":"Execute","hide":[],"disable":[]}]]}},"layers":{"Default layer":{"position":{"left":0,"top":89},"size":{"width":56,"height":60},"zIndex":0,"display":false,"title":"Monitoring configuration file","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Admin":{"position":{"left":57,"top":0},"size":{"width":52,"height":38},"zIndex":0,"display":true,"title":"Monitoring configuration file","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"preferences":{"position":{"left":57,"top":142},"size":{"width":73,"height":27},"zIndex":0,"display":false,"title":"Monitoring configuration file","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"import data":{"position":{"left":66,"top":9},"size":{"width":52,"height":62},"zIndex":0,"display":false,"title":"Monitoring configuration file","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"results":{"position":{"left":66,"top":9},"size":{"width":52,"height":62},"zIndex":0,"display":false,"title":"Monitoring configuration file","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"create":{"position":{"left":0,"top":89},"size":{"width":56,"height":60},"zIndex":0,"display":false,"title":"Monitoring configuration file","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Load and Process":{"position":{"left":0,"top":89},"size":{"width":56,"height":60},"zIndex":0,"display":false,"title":"Monitoring configuration file","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"}},"id":82,"vars_in":[{"rel":"inputValue","name":"preferences"},{"rel":"inputValue","name":"datasetSamples"}],"actions_in":[{}],"vars_out":[{"jpath":[]}],"actions_out":[{"jpath":[]}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[["Open Preferences"]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"Monitoring configuration file","zindex":2},{"url":"modules/types/client_interaction/code_executor/","configuration":{"sections":{},"groups":{"group":[{"display":[["editor","buttons"]],"execOnLoad":[[]],"asyncAwait":[["top"]],"script":["if (! this.button) this.button='Default layer';\n\nvar layers={\n    'Default layer': {\n        layer: 'Default layer'\n    },\n    'results': {\n        layer: 'results'\n    },\n    'create': {\n        layer: 'create'\n    }\n}\n\nif (layers[this.button]) {\n    for (var key of Object.keys(layers)) {\n        this.enableButton(key);\n    }\n    API.switchToLayer(layers[this.button].layer);\n    if (layers[this.button].callback) {\n        layers[this.button].callback();\n    }\n    this.disableButton(this.button);\n}"]}],"libs":[[{}]],"buttons":[[{"name":"Default layer","label":"Home","hide":[],"disable":["disable"]},{"name":"create","label":"Create","hide":[],"disable":[]},{"name":"results","label":"Result","hide":[],"disable":[]},{"name":"button1","label":"Execute","hide":["hide"],"disable":[]}]]}},"layers":{"Default layer":{"position":{"left":9,"top":0},"size":{"width":46,"height":5},"zIndex":0,"display":true,"title":"","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"Default layer"},"Admin":{"position":{"left":0,"top":0},"size":{"width":46,"height":5},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"Admin"},"preferences":{"position":{"left":0,"top":0},"size":{"width":38,"height":5},"zIndex":0,"display":true,"title":"","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"preferences"},"import data":{"position":{"left":0,"top":0},"size":{"width":46,"height":5},"zIndex":0,"display":true,"title":"","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"Admin"},"results":{"position":{"left":9,"top":0},"size":{"width":46,"height":5},"zIndex":0,"display":true,"title":"","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"Admin"},"create":{"position":{"left":9,"top":0},"size":{"width":46,"height":5},"zIndex":0,"display":true,"title":"","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"Default layer"},"Load and Process":{"position":{"left":9,"top":0},"size":{"width":46,"height":5},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"Default layer"}},"id":83,"vars_in":[{}],"actions_in":[{}],"vars_out":[{"jpath":[]}],"actions_out":[{"jpath":[]}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[["Open Preferences"]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"","zindex":35},{"url":"modules/types/client_interaction/code_editor/","configuration":{"sections":{},"groups":{"group":[{"mode":["html"],"outputType":[null],"btnvalue":["Send script"],"iseditable":[["editable"]],"hasButton":[["button"]],"variable":[[]],"storeOnChange":[["store"]],"debouncing":[2000],"script":["<style>\n    #extendedFormDataset{\n        padding: 10px;\n    }\n    #extendedFormDataset input[type=number]{\n        width: 60px;\n    }\n    #extendedFormDataset input, #extendedFormDataset select {\n        margin-top: 10px;\n        margin-bottom: 3px;\n    }\n</style>\n\n<div id='#extendedFormDataset'>\n    <form>\n        <h2> Concentration settings for non biomarkers </h2>\n        <br>\n        <table>\n            <tbody>\n                <tr>\n                    <th></th><th></th>\n                    <th>Distribution</th>\n                    <th></th><th></th>\n                    <th>Mean</th>\n                    <th></th><th></th>\n                    <th>Standard deviation</th>\n                    <th></th>\n                </tr>\n                <tr>\n                    <td><td><br></td></td>\n                    <td>\n                        <select name = 'dataset.distribution' >\n                            <option value=\"\"></option>\n                            <option value=\"normal\"> Normal </option>\n                        </select>\n                    </td>\n                    <td><td><br></td></td>\n                    <td> \n                        min: <input name = 'dataset.mean.min' size=\"5\">\n                        max: <input name = 'dataset.mean.max' size=\"5\">\n                     </td>\n                    <td><td><br></td></td>\n                    <td>\n                        min: <input name = 'dataset.std.min' size=\"5\">\n                        max: <input name = 'dataset.std.max' size=\"5\">\n                    </td>\n                    <td></td>\n                </tr>\n            </tbody>\n        </table>\n    </form>\n</div>\n\n"]}],"ace":[{"useSoftTabs":[["yes"]],"tabSize":[4]}]}},"layers":{"Default layer":{"position":{"left":0,"top":103},"size":{"width":37,"height":55},"zIndex":0,"display":false,"title":"Distribution settings template","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Admin":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"Distribution settings template","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"preferences":{"position":{"left":94,"top":18},"size":{"width":34,"height":16},"zIndex":0,"display":true,"title":"Distribution settings template","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"preferences"},"import data":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"Distribution settings template","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"results":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"Distribution settings template","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"create":{"position":{"left":0,"top":103},"size":{"width":37,"height":55},"zIndex":0,"display":false,"title":"Distribution settings template","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Load and Process":{"position":{"left":0,"top":103},"size":{"width":37,"height":55},"zIndex":0,"display":false,"title":"Distribution settings template","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"}},"id":84,"vars_in":[{}],"actions_in":[{}],"vars_out":[{"event":"onEditorChange","rel":"data","jpath":[],"name":"datasetPreferences"}],"actions_out":[{"jpath":[]}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[["Open Preferences"]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"Distribution settings template","zindex":2},{"url":"modules/types/display/template-twig/","configuration":{"sections":{},"groups":{"group":[{"selectable":[[]],"template":[""],"modifyInForm":[["yes"]],"debouncing":[100],"formOptions":[["keepFormValueIfDataUndefined"]]}]}},"layers":{"Default layer":{"position":{"left":42,"top":13},"size":{"width":48,"height":10},"zIndex":0,"display":true,"title":"","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"Default layer"},"Admin":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"preferences":{"position":{"left":129,"top":18},"size":{"width":41,"height":12},"zIndex":0,"display":true,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"preferences"},"import data":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"results":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"create":{"position":{"left":37,"top":12},"size":{"width":48,"height":10},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"Default layer"},"Load and Process":{"position":{"left":42,"top":13},"size":{"width":48,"height":10},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"Default layer"}},"id":85,"vars_in":[{"rel":"tpl","name":"datasetPreferences"},{"rel":"form","name":"preferences"}],"actions_in":[{}],"vars_out":[{"event":"onFormSubmitted","rel":"form","jpath":[],"name":"formSubmitted"}],"actions_out":[{"jpath":[]}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[[]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"","zindex":18},{"url":"modules/types/client_interaction/code_editor/","configuration":{"sections":{},"groups":{"group":[{"mode":["html"],"outputType":[null],"btnvalue":["Send script"],"iseditable":[["editable"]],"hasButton":[["button"]],"variable":[[]],"storeOnChange":[["store"]],"debouncing":[2000],"script":["<style>\n    #extendedForm_{\n        padding: 10px;\n    }\n    #extendedForm_ input[type=number]{\n        width: 100px;\n    }\n    #extendedForm_ input, #extendedForm_ select {\n        margin-top: 10px;\n        margin-bottom: 3px;\n    }\n    #extendedForm select[type=number]{\n        width: 60px;\n    }\n</style>\n\n<div id='#extendedForm_'>\n    <form>\n        <h2 align='center'> General settings </h2>\n        <br>\n        <table>\n            <tbody>\n                <p>\n                    <td><th> Number of Classes in dataset: </th></td>\n                    <td><br></td>\n                    <td>\n                        <select  name='nbClasses'>\n                            <option value=1> 1 </option>\n                            <option value=2> 2 </option>\n                            <option value=3> 3 </option>\n                            <option value=4> 4 </option>\n                            <option value=5> 5 </option>\n                            <option value=6> 6 </option>\n                            <option value=7> 7 </option>\n                            <option value=8> 8 </option>\n                            <option value=9> 9 </option>\n                            <option value=10> 10 </option>\n                        </select>\n                    </td>\n                    <td><th> Number of points in spectra: </th></td>\n                    <td>\n                        <input name = 'nbPoints' type=\"number\" style=\"width:50px\">\n                    </td>\n                </p>\n            </tbody>\n        </table>\n    </form>\n</div>\n\n"]}],"ace":[{"useSoftTabs":[["yes"]],"tabSize":[4]}]}},"layers":{"Default layer":{"position":{"left":0,"top":103},"size":{"width":37,"height":55},"zIndex":0,"display":false,"title":"General settings template","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Admin":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"General settings template","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"preferences":{"position":{"left":94,"top":6},"size":{"width":34,"height":11},"zIndex":0,"display":true,"title":"General settings template","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"preferences"},"import data":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"General settings template","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"results":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"General settings template","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"create":{"position":{"left":0,"top":103},"size":{"width":37,"height":55},"zIndex":0,"display":false,"title":"General settings template","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Load and Process":{"position":{"left":0,"top":103},"size":{"width":37,"height":55},"zIndex":0,"display":false,"title":"General settings template","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"}},"id":86,"vars_in":[{}],"actions_in":[{}],"vars_out":[{"event":"onEditorChange","rel":"data","jpath":[],"name":"classesTwig"}],"actions_out":[{"jpath":[]}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[["Open Preferences"]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"General settings template","zindex":2},{"url":"modules/types/display/template-twig/","configuration":{"sections":{},"groups":{"group":[{"selectable":[[]],"template":[""],"modifyInForm":[["yes"]],"debouncing":[1000],"formOptions":[["keepFormValueIfDataUndefined"]]}]}},"layers":{"Default layer":{"position":{"left":42,"top":7},"size":{"width":44,"height":10},"zIndex":0,"display":true,"title":"","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"Default layer"},"Admin":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"preferences":{"position":{"left":129,"top":6},"size":{"width":41,"height":11},"zIndex":0,"display":true,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"preferences"},"import data":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"results":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"create":{"position":{"left":37,"top":6},"size":{"width":44,"height":10},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"Default layer"},"Load and Process":{"position":{"left":42,"top":7},"size":{"width":44,"height":10},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"Default layer"}},"id":87,"vars_in":[{"rel":"tpl","name":"classesTwig"},{"rel":"form","name":"preferences"}],"actions_in":[{}],"vars_out":[{"event":"onFormChanged","rel":"form","jpath":[],"name":"formSubmitted"}],"actions_out":[{"event":"onFormChanged","rel":"form","jpath":["nbClasses"],"name":"updateClass"}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[[]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"","zindex":2},{"url":"modules/types/display/template-twig/","configuration":{"sections":{},"groups":{"group":[{"selectable":[[]],"template":[""],"modifyInForm":[["yes"]],"debouncing":[0],"formOptions":[["keepFormValueIfDataUndefined"]]}]}},"layers":{"Default layer":{"position":{"left":88,"top":6},"size":{"width":87,"height":80},"zIndex":0,"display":true,"title":"","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"Default layer"},"Admin":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"preferences":{"position":{"left":55,"top":6},"size":{"width":38,"height":70},"zIndex":0,"display":true,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"preferences"},"import data":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"results":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"create":{"position":{"left":86,"top":6},"size":{"width":87,"height":80},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"Default layer"},"Load and Process":{"position":{"left":88,"top":6},"size":{"width":87,"height":80},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"Default layer"}},"id":88,"vars_in":[{"rel":"tpl","name":"datasetTemplate"},{"rel":"form","name":"configurationFile"}],"actions_in":[{"rel":"_editPreferences","name":"updateTwig"}],"vars_out":[{"jpath":[]}],"actions_out":[{"jpath":[]}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[[]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"","zindex":2},{"url":"modules/types/client_interaction/code_editor/","configuration":{"sections":{},"groups":{"group":[{"mode":["html"],"outputType":[null],"btnvalue":["Send script"],"iseditable":[["editable"]],"hasButton":[["button"]],"variable":[[]],"storeOnChange":[["store"]],"debouncing":[0],"script":["<style>\n    #extendedForm {\n        padding: 10px;\n    }\n    #extendedForm h1 {\n        font-size: 16px;\n        padding-top: 12px;\n        padding-bottom: 4px;\n        space\n    }\n    #extendedForm h2 {\n        font-size: 12px;\n        margin-top: 12px;\n        margin-bottom: 4px;\n        space\n    }\n    #extendedForm input[type=number]{\n        width: 60px;\n    }\n    #extendedForm select[type=number]{\n        width: 60px;\n    }\n    #extendedForm input, #extendedForm select {\n        margin-top: 3px;\n        margin-bottom: 3px;\n    } \n</style>\n\n<div id='extendedForm'>\n    <form>\n        <table>\n            <h1>Concentration settings for selected biomarkers</h1>\n        </table>\n        <table id='table'>\n            <tr>\n                <th style=\"padding-top: 10px\"> Selected biomarker </th>\n                {% for j in 0..configurationFile.classes.length - 1 %}\n                <th style=\"padding-top: 10px\"> Class: {{j+1}} </th>\n                {% endfor %}\n            </tr>\n\n            <tr >\n                <td id='nbSpectra' style=\"padding-top: 10px\"> </td>\n                {% for j in 0..configurationFile.classes.length - 1 %}\n                <td style=\"padding-left: 40px\">\n                    Nb of spectra <input name = 'classes.{{j}}.nbSpectra' size=\"4\" type=\"number\">\n                </td>\n                {% endfor %}\n            </tr>\n            <tr></tr>\n            {% for i in 0..configurationFile.classes[0].unitParameters.length - 1 %}\n            {% if configurationFile.classes[0].unitParameters[i].isBiomarker == true %}\n            <tr>\n                <td style=\"padding-right: 20px\">\n                {{ rendertype(configurationFile.classes[0].unitParameters[i].molfile,{width:100, height:100},'mol2d') }}\n                </td>\n                {% for j in 0..configurationFile.classes.length - 1 %}\n                <td>\n                    <table>\n                        <tr>\n                            <td></td>\n                            <td \"padding-top: 50px\">\n                                Concentration: <input  name = 'classes.{{j}}.unitParameters.{{i}}.distribution.parameters.mean' size=\"4\" type=\"number\" value =''>\n                                Std: <input name = 'classes.{{j}}.unitParameters.{{i}}.distribution.parameters.standardDeviation' size=\"4\" type=\"number\" value = ''>\n                            </td>\n                            <td></td>\n                        </tr>\n                    </table>\n                </td>\n                {% endfor %}\n            </tr>\n            {% endif %}\n            {% endfor %}\n        </table>\n    </form>\n</div>\n\n<script>\n    require(['vh/util/twigAdvancedForm'], function(AF) {\n        AF('extendedForm', {debug:false});\n    });\n</script>\n\n"]}],"ace":[{"useSoftTabs":[["yes"]],"tabSize":[4]}]}},"layers":{"Default layer":{"position":{"left":9,"top":165},"size":{"width":64,"height":107},"zIndex":0,"display":false,"title":"Biomarkers distribution template","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Admin":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"Biomarkers distribution template","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"preferences":{"position":{"left":0,"top":6},"size":{"width":54,"height":70},"zIndex":0,"display":true,"title":"Biomarkers distribution template","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"preferences"},"import data":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"Biomarkers distribution template","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"results":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"Biomarkers distribution template","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"create":{"position":{"left":9,"top":165},"size":{"width":64,"height":107},"zIndex":0,"display":false,"title":"Biomarkers distribution template","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Load and Process":{"position":{"left":9,"top":165},"size":{"width":64,"height":107},"zIndex":0,"display":false,"title":"Biomarkers distribution template","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"}},"id":89,"vars_in":[{}],"actions_in":[{}],"vars_out":[{"event":"onEditorChange","rel":"data","jpath":[],"name":"datasetTemplate"}],"actions_out":[{"jpath":[]}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[["Open Preferences"]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"Biomarkers distribution template","zindex":2},{"url":"modules/types/client_interaction/code_executor/","configuration":{"sections":{},"groups":{"group":[{"display":[["editor","buttons"]],"execOnLoad":[[]],"asyncAwait":[["top"]],"script":["const Matrix = ML.MatrixLib.Matrix;\nconst configurationFile = API.getData('configurationFile').resurrect();\nconst preferences = API.getData('preferences').resurrect();\nconst classes = configurationFile.classes.map((element) => element.nbSpectra)\nconst spectraProcessor = API.cache('spectraProcessor');\n\nspectraProcessor.setNormalization({\n        from: 0,\n        to: 10,\n        numberOfPoints: preferences.nbPoints\n    })\n\nconst defaultOptions = {\n    frequency: 400,\n    from: 0,\n    to: 10,\n    lineWidth: 1,\n    nbPoints: 256 * 4,\n    maxClusterSize: 6,\n    withNoise: true\n};\n\nlet k=0;\nlet elements = [];\nfor (let element of configurationFile.classes[0].unitParameters) {\n    await delay(0)\n    statusProgressFunction((k + 1), configurationFile.classes[0].unitParameters.length);\n    k++\n    if (element.molfile === undefined) continue\n    const molecule = OCLE.Molecule.fromMolfile(element.molfile);\n    const prediction = await nmrPredictor.spinus(molecule.toMolfile(), {OCLE:OCLE});\n    const simulation = SD.NMR.fromSignals(prediction, configurationFile || defaultOptions);\n    elements.push(simulation.getYData());\n}\n\nlet pureElements = [];\nfor (let i = 0; i < configurationFile.classes.length; i++) {\n    for (let j = 0; j < elements.length; j++) {\n        configurationFile.classes[i].unitParameters[j].index = i * elements.length + j;\n        pureElements[i * elements.length + j] = elements[j];\n    }\n}\n\nlet result;\nif (configurationFile && pureElements) {\n    result = generateDataset(pureElements, configurationFile);\n    result.pureElements = pureElements;\n    const variationMatrix = Matrix.rand(result.dataset.rows, result.dataset.columns)\n        .mul(preferences.noiseFactor);\n    result.dataset = result.dataset.add(variationMatrix);\n    API.createData('export', \n        Object.entries(result).map((element) => element = {\n            id: element[0],\n        })\n    );\n}\n\n\n\n\nconst xAxis = new Array(result.dataset.columns)\n    .fill().map((item, index) => index * 10 / result.dataset.columns)\nconst colors = Colors.getDistinctColorsAsString(parseInt(preferences.nbClasses));\nlet dataset = [];\nfor (let i = 0; i < classes.length; i++) {\n    for (let j = 0; j < classes[i]; j++) {\n        spectraProcessor.addFromData({\n            x: xAxis,\n            y: result.dataset.getRow(i),\n        }, {\n            id: `sample${classes[i] * i+j}`,\n            meta: {\n                category: `class${i + 1}`,\n                color: colors[i]\n            }\n        });\n        \n        dataset.push({\n            label: `sample${classes[i] * i+j}`,\n            category: `class${i + 1}`,\n            spectrum: {\n                x: xAxis,\n                y: Array.from(result.dataset.data[classes[i] * i+j]),\n                styles: {\n                    selected: {\n                        lineColor: colors[i],\n                        lineStyle: 1,\n                        lineWidth: 1,\n                    },\n                    unselected: {\n                        lineColor: colors[i],\n                        lineStyle: 1,\n                        lineWidth: 1,\n                    },\n                }\n            },\n            _highlight: classes[i]*i+j+1\n        })\n    }\n}\n\nlet spectraInDataset=[];\nfor (let spectrum of spectraProcessor.spectra) {\n    console.log(spectrum.id)\n    spectraInDataset.push( {\n        id: spectrum.id,\n        selected: true,\n        pcaModel: false,\n        category: spectrum.meta.category,\n        color: spectrum.meta.color,\n        toc: {\n            value: {\n                reference: spectrum.id,\n                misc: {\n                    id: spectrum.id,\n                    ...spectrum.meta\n                }\n            }\n        },\n        _highlight: Math.random()\n    })\n}\n\nAPI.createData('memoryInfo', spectraProcessor.getMemoryInfo());\n\nAPI.createData('spectraInDataset', spectraInDataset);\n\nAPI.createData('keepOriginal', false);\n\nAPI.createData('toDisplay', dataset);\n\nAPI.switchToLayer('results');\nUI.showNotification('The artificial data set was successfully generated', 'success');\n\nasync function statusProgressFunction(currentStatus, iterationsNumber) {\n    let status = currentStatus < iterationsNumber? currentStatus: 0;\n    API.createData('statusProgress', {\n        currentStatus: status,\n        iterationsNumber: iterationsNumber\n    });\n};\n"]}],"libs":[[{"lib":"OCLE","alias":"OCLE"},{"lib":"nmr-predictor","alias":"nmrPredictor"},{"lib":"spectra-data","alias":"SD"},{"lib":"generateDataset","alias":"generateDataset"},{"lib":"ML","alias":"ML"},{"lib":"src/util/ui","alias":"UI"},{"lib":"delay","alias":"delay"},{"lib":"src/util/color","alias":"Colors"}]],"buttons":[[{"name":"button1","label":"Generate dataset","hide":[],"disable":[]}]]}},"layers":{"Default layer":{"position":{"left":52,"top":1},"size":{"width":20,"height":4},"zIndex":0,"display":true,"title":"Generate dataset from configuration file","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"Default layer"},"Admin":{"position":{"left":0,"top":0},"size":{"width":56,"height":59},"zIndex":0,"display":true,"title":"Generate dataset from configuration file","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"preferences":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"Generate dataset from configuration file","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"preferences"},"import data":{"position":{"left":0,"top":9},"size":{"width":65,"height":82},"zIndex":0,"display":false,"title":"Generate dataset from configuration file","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"results":{"position":{"left":0,"top":9},"size":{"width":65,"height":82},"zIndex":0,"display":false,"title":"Generate dataset from configuration file","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"create":{"position":{"left":52,"top":1},"size":{"width":20,"height":4},"zIndex":0,"display":false,"title":"Generate dataset from configuration file","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"Default layer"},"Load and Process":{"position":{"left":52,"top":1},"size":{"width":20,"height":4},"zIndex":0,"display":false,"title":"Generate dataset from configuration file","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"Default layer"}},"id":90,"vars_in":[{}],"actions_in":[{}],"vars_out":[{"jpath":[]}],"actions_out":[{"jpath":[]}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[["Open Preferences"]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"Generate dataset from configuration file","zindex":2},{"url":"modules/types/display/template-twig/","configuration":{"sections":{},"groups":{"group":[{"selectable":[[]],"template":["<style> \n    #calculationStatus2 {\n      height: 40px;\n      width: 100%;\n      background-color: #ddd; \n      border-radius: 5px;\n      top: 180px;\n      margin-bottom: 50px;\n      box-shadow:2px 0px 12px 3px rgba(0, 0, 0, 0.3) inset;\n      padding: 8px;\n    } \n    @keyframes move{\n        100%{\n            background-position: 40px 0px;\n        }\n    }  \n    #statusBar2 { \n      width: 10%; \n      height: 25px;\n      background: linear-gradient(45deg,rgba(255, 255, 255, 0.5) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.5) 50%, rgba(255, 255, 255, 0.5) 75%, transparent 75%, transparent);\n      background-color: #196C7F;\n      background-size: 40px;\n      border-radius: 5px;\n      padding: 8px;\n      /*animation: move 1.0s linear infinite;*/\n    }\n    \n    #statusLabel2 {\n      text-align: center;\n      color: white;\n    }\n</style>\n\n<body>\n    {% if (statusProgress.currentStatus)%}\n    <h2 id='label' align='center'></h2> \n    <div id=\"calculationStatus2\">\n        <div id=\"statusBar2\"><p id='statusLabel2'>{{rendertype(statusProgress.currentStatus, {numeral:'0.00'})}} %</p></div>\n    </div>\n    {% endif %}\n    <script>\n        $('#calculationStatus2').width(390);\n        const currentStatus = {{statusProgress.currentStatus}};\n        const iterationsNumber = {{statusProgress.iterationsNumber}};\n        let label = 'Molfile '+String(currentStatus + 1)+' of '+String(iterationsNumber);\n        $('#label').text(label);\n        let progress = (currentStatus + 1) / iterationsNumber*100;\n        progress = Math.round(progress * 100) / 100;\n        $('#statusBar2').width(progress * 3.6);\n        $('#statusLabel2').text(String(progress) + '%');\n        if (progress === 100) {\n            $('#statusLabel2').text('Finished');\n        }\n    </script> \n</body>\n"],"modifyInForm":[[]],"debouncing":[0],"formOptions":[["keepFormValueIfDataUndefined"]]}]}},"layers":{"Default layer":{"position":{"left":82,"top":0},"size":{"width":42,"height":10},"zIndex":0,"display":true,"title":"","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"Default layer"},"Admin":{"position":{"left":0,"top":89},"size":{"width":52,"height":8},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"preferences":{"position":{"left":55,"top":0},"size":{"width":38,"height":5},"zIndex":0,"display":true,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"preferences"},"import data":{"position":{"left":36,"top":0},"size":{"width":52,"height":8},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"results":{"position":{"left":36,"top":0},"size":{"width":52,"height":8},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"create":{"position":{"left":82,"top":0},"size":{"width":42,"height":10},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"Default layer"},"Load and Process":{"position":{"left":82,"top":0},"size":{"width":42,"height":10},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"Default layer"}},"id":91,"vars_in":[{"rel":"value","name":"statusProgress"}],"actions_in":[{}],"vars_out":[{"jpath":[]}],"actions_out":[{"jpath":[]}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[["Open Preferences"]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"","zindex":1},{"url":"modules/types/client_interaction/code_editor/","configuration":{"sections":{},"groups":{"group":[{"mode":["html"],"outputType":[null],"btnvalue":["Send script"],"iseditable":[["editable"]],"hasButton":[["button"]],"variable":[[]],"storeOnChange":[["store"]],"debouncing":[2000],"script":["<style>\n    #extendedFormPca{\n        padding: 10px;\n    }\n    #extendedFormPca input[type=number]{\n        width: 100px;\n    }\n    #extendedFormPca input, #extendedFormPca select {\n        margin-top: 10px;\n        margin-bottom: 3px;\n    } \n</style>\n\n<div id='#extendedFormPca'>\n    <form>\n        <h1>PCA preferences </h1>\n    <table>\n        <tbody>\n            <tr>\n                <td>\n                 X: <select name=\"x\">\n                        <option value=\"0\">PC 1</option>\n                        <option value=\"1\">PC 2</option>\n                        <option value=\"2\">PC 3</option>\n                        <option value=\"3\">PC 4</option>\n                    </select>\n                </td>\n                <td>\n                 - Y: <select name=\"y\">\n                        <option value=\"0\">PC 1</option>\n                        <option value=\"1\">PC 2</option>\n                        <option value=\"2\">PC 3</option>\n                        <option value=\"3\">PC 4</option>\n                    </select> \n                </td>\n                <td>\n                    Display ellipse <input name =\"ellipse.display\" style='size: 10px' size=\"6\" type=\"checkbox\"> <br>\n                </td>\n                <td>\n                    Standard deviation: <input name =\"ellipse.std\" type=\"number\" size=\"4\"> <br>\n                </td>\n                <td>\n                    Ellipse opacity: <input name =\"ellipse.fillOpacity\" size=\"6\" type=\"number\">\n                </td>\n            </tr>\n        </tbody>\n    </table>\n    </form>\n</div>\n\n"]}],"ace":[{"useSoftTabs":[["yes"]],"tabSize":[4]}]}},"layers":{"Default layer":{"position":{"left":0,"top":103},"size":{"width":37,"height":55},"zIndex":0,"display":false,"title":"PCA preferences template","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Admin":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"PCA preferences template","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"preferences":{"position":{"left":94,"top":35},"size":{"width":34,"height":13},"zIndex":0,"display":true,"title":"PCA preferences template","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"preferences"},"import data":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"PCA preferences template","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"import data"},"results":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"PCA preferences template","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"results"},"create":{"position":{"left":0,"top":103},"size":{"width":37,"height":55},"zIndex":0,"display":false,"title":"PCA preferences template","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Load and Process":{"position":{"left":0,"top":103},"size":{"width":37,"height":55},"zIndex":0,"display":false,"title":"PCA preferences template","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"}},"id":92,"vars_in":[{}],"actions_in":[{}],"vars_out":[{"event":"onEditorChange","rel":"data","jpath":[],"name":"pcaTwig"}],"actions_out":[{"jpath":[]}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[["Open Preferences"]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"PCA preferences template","zindex":2},{"url":"modules/types/client_interaction/button_action/","configuration":{"sections":{},"groups":{"group":[{"toggle":["click"],"label":["Download"],"onLabel":["Toggle action off"],"offLabel":["Toggle action on"],"title":["Download selected elements"],"css":["font-size: 11px;\nbackground-color: #E6E6E6;\nborder: 1px solid rgba(0, 0, 0, 0.2);\nheight: 30px;\npadding: .5em 1em;\nfont-weight: bold;"],"cssOn":["font-size: 11px;\nbackground-color: #E6E6E6;\nborder: 1px solid rgba(0, 0, 0, 0.2);\nheight: 30px;\npadding: .5em 1em;\nfont-weight: bold;"],"cssOff":["font-size: 11px;\nbackground-color: #E6E6E6;\nborder: 1px solid rgba(0, 0, 0, 0.2);\nheight: 30px;\npadding: .5em 1em;\nfont-weight: bold;"],"startState":["off"],"text":["downloadSelectedElements"],"askConfirm":[[]],"confirmText":["Are you sure?"],"okLabel":["Ok"],"cancelLabel":["Cancel"],"contentType":["svg"],"content":["<svg version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\"\n\t width=\"330\" height=\"330\" viewBox=\"0 0 330 330\" xml:space=\"preserve\">\n<g id=\"XMLID_24_\">\n\t<path id=\"XMLID_25_\" d=\"M154.389,265.602c0.351,0.35,0.719,0.683,1.103,0.997c0.169,0.138,0.347,0.258,0.52,0.388\n\t\tc0.218,0.164,0.432,0.333,0.659,0.484c0.212,0.142,0.432,0.265,0.649,0.395c0.202,0.121,0.4,0.248,0.608,0.359\n\t\tc0.224,0.12,0.453,0.221,0.681,0.328c0.215,0.102,0.427,0.21,0.648,0.301c0.223,0.092,0.45,0.167,0.676,0.247\n\t\tc0.235,0.085,0.468,0.175,0.709,0.248c0.226,0.068,0.456,0.119,0.685,0.176c0.246,0.062,0.489,0.131,0.739,0.181\n\t\tc0.263,0.052,0.528,0.083,0.794,0.121c0.219,0.031,0.435,0.073,0.658,0.095c0.492,0.048,0.986,0.075,1.48,0.075\n\t\tc0.494,0,0.988-0.026,1.48-0.075c0.225-0.022,0.444-0.064,0.667-0.096c0.262-0.037,0.524-0.068,0.784-0.12\n\t\tc0.255-0.05,0.503-0.121,0.754-0.184c0.223-0.057,0.448-0.105,0.669-0.172c0.246-0.075,0.483-0.167,0.724-0.253\n\t\tc0.221-0.08,0.444-0.152,0.662-0.242c0.225-0.093,0.44-0.202,0.659-0.306c0.225-0.106,0.452-0.206,0.672-0.324\n\t\tc0.21-0.112,0.408-0.239,0.611-0.361c0.217-0.13,0.437-0.252,0.648-0.394c0.222-0.148,0.431-0.314,0.643-0.473\n\t\tc0.179-0.134,0.362-0.258,0.536-0.4c0.365-0.3,0.714-0.617,1.049-0.949c0.016-0.016,0.033-0.028,0.049-0.044l70.002-69.998\n\t\tc5.858-5.858,5.858-15.355,0-21.213c-5.857-5.858-15.355-5.857-21.213-0.001l-44.396,44.393V15c0-8.284-6.716-15-15-15\n\t\tc-8.284,0-15,6.716-15,15v203.785l-44.392-44.391c-5.858-5.858-15.356-5.858-21.213,0c-5.858,5.858-5.858,15.355,0,21.213\n\t\tL154.389,265.602z\"/>\n\t<path id=\"XMLID_26_\" d=\"M315,300H15c-8.284,0-15,6.716-15,15s6.716,15,15,15h300c8.284,0,15-6.716,15-15S323.284,300,315,300z\"/>\n</g>\n</svg>\n"],"maskOpacity":[0.6]}]}},"layers":{"Default layer":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Admin":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"preferences":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"preferences"},"import data":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"import data"},"results":{"position":{"left":82,"top":51},"size":{"width":14,"height":17},"zIndex":0,"display":true,"title":"","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"results"},"create":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Load and Process":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"}},"id":93,"vars_in":[],"actions_in":[{}],"vars_out":[],"actions_out":[{"event":"onClick","rel":"actionText","jpath":[],"name":"downloadSelectedElements"}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[["Open Preferences"]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"","zindex":2},{"url":"modules/types/client_interaction/code_executor/","configuration":{"sections":{},"groups":{"group":[{"display":[["editor","buttons"]],"execOnLoad":[[]],"asyncAwait":[["top"]],"script":["const preferences = API.getData('preferences').resurrect();\nconst spectraProcessor = API.cache('spectraProcessor');\n\nconst mimetype =  preferences.export.format === 'tsv' ? \n    'text/tab-separated-values' : 'text/csv';\n\nconst text = spectraProcessor.getNormalizedText({\n    fs: preferences.export.format === 'tsv' ? '\\t' : ','\n});\n\nconst blob = new Blob([text], {type: mimetype+\";charset=utf-8\"});\nfileSaver( blob, `dataset.${preferences.export.format}`);"]}],"libs":[[{"lib":"file-saver","alias":"fileSaver"}]],"buttons":[[{"name":"button1","label":"Execute","hide":[],"disable":[]}]]}},"layers":{"Default layer":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"Download dataset","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Admin":{"position":{"left":110,"top":63},"size":{"width":56,"height":25},"zIndex":0,"display":true,"title":"Download dataset","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"preferences":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"Download dataset","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"preferences"},"import data":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"Download dataset","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"import data"},"results":{"position":{"left":45,"top":101},"size":{"width":46,"height":24},"zIndex":0,"display":false,"title":"Download dataset","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"results"},"create":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"Download dataset","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Load and Process":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"Download dataset","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"}},"id":94,"vars_in":[{}],"actions_in":[{"rel":"execute","name":"downloadSelectedElements"}],"vars_out":[{"jpath":[]}],"actions_out":[{"jpath":[]}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[["Open Preferences"]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"Download dataset","zindex":2},{"url":"modules/types/client_interaction/code_editor/","configuration":{"sections":{},"groups":{"group":[{"mode":["text"],"outputType":[null],"btnvalue":["Add list of SMILES"],"iseditable":[["editable"]],"hasButton":[["button"]],"variable":[[]],"storeOnChange":[["store"]],"debouncing":[0],"script":["CN1C=NC2=C1C(=O)N(C(=O)N2C)C\nC[N+]1=CC=CC(=C1)C(=O)[O-]"]}],"ace":[{"useSoftTabs":[["yes"]],"tabSize":[4]}]}},"layers":{"Default layer":{"position":{"left":0,"top":0},"size":{"width":44,"height":21},"zIndex":0,"display":false,"title":"List of SMILES","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Admin":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"preferences":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"preferences"},"import data":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"import data"},"results":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"results"},"create":{"position":{"left":0,"top":6},"size":{"width":44,"height":21},"zIndex":0,"display":true,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"create"},"Load and Process":{"position":{"left":0,"top":0},"size":{"width":44,"height":21},"zIndex":0,"display":false,"title":"List of SMILES","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"}},"id":95,"vars_in":[{}],"actions_in":[{}],"vars_out":[{"event":"onButtonClick","rel":"data","jpath":[],"name":"smilesList"}],"actions_out":[{"jpath":[]}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[[]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"","zindex":2},{"url":"modules/types/display/template-twig/","configuration":{"sections":{},"groups":{"group":[{"selectable":[[]],"template":["<style>\n    #parametersForm {\n        padding: 10px;\n    }\n    #parametersForm .addRow {\n        color: green;\n        font-weight: bold;\n        font-size: 12px;\n        padding: .4em .6em;\n    }\n    #parametersForm .removeRow {\n        color: red;\n        font-weight: bold;\n        font-size: 12px;\n        padding: .4em .8em;\n    }\n    #parametersForm h1 {\n        font-size: 16px;\n        padding-top: 12px;\n        padding-bottom: 4px;\n        space\n    }\n    #parametersForm h2 {\n        font-size: 12px;\n        margin-top: 12px;\n        margin-bottom: 4px;\n        space\n    }\n    #parametersForm input[type=number]{\n        width: 60px;\n    }\n    #parametersForm input, #parametersForm select {\n        margin-top: 3px;\n        margin-bottom: 3px;\n    } \n</style>\n\n<div id='parametersForm'>\n    <table>\n        <h1> Parameters </h1>\n        <tr>\n            <th></th><th></th>\n            <th> Name </th>\n        </tr>\n        <tr data-repeat='label'>\n            <td>\n                <input data-field='' type='string' style=\"width:100px\">\n            </td>\n        </tr>\n    </table>\n</div>\n\n<script>\n    require(['vh/util/twigAdvancedForm'], function(AF) {\n        AF('parametersForm', {debug:false});\n    });\n</script>"],"modifyInForm":[["yes"]],"debouncing":[500],"formOptions":[["keepFormValueIfDataUndefined"]]}]}},"layers":{"Default layer":{"position":{"left":45,"top":0},"size":{"width":56,"height":21},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Admin":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"preferences":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"preferences"},"import data":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"import data"},"results":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"results"},"create":{"position":{"left":45,"top":6},"size":{"width":51,"height":21},"zIndex":0,"display":true,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"create"},"Load and Process":{"position":{"left":45,"top":0},"size":{"width":56,"height":21},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"}},"id":96,"vars_in":[{"rel":"form","name":"parameters"}],"actions_in":[{}],"vars_out":[{"jpath":[]}],"actions_out":[{"jpath":[]}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[[]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"","zindex":8},{"url":"modules/types/science/chemistry/ocl_editor/","configuration":{"sections":{},"groups":{"group":[{"prefs":[["svg"]]}]}},"layers":{"Default layer":{"position":{"left":0,"top":22},"size":{"width":44,"height":39},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Admin":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"preferences":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"preferences"},"import data":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"import data"},"results":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"results"},"create":{"position":{"left":0,"top":28},"size":{"width":44,"height":39},"zIndex":0,"display":true,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"create"},"Load and Process":{"position":{"left":0,"top":22},"size":{"width":44,"height":39},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"}},"id":97,"vars_in":[{}],"actions_in":[{}],"vars_out":[{"event":"onStructureChange","rel":"mol","jpath":[],"name":"molfile"}],"actions_out":[{"jpath":[]}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[[]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"","zindex":1},{"url":"modules/types/edition/slick_grid/","configuration":{"sections":{},"groups":{"group":[{"slickCheck":[["enableCellNavigation","rowNumbering","forceFitColumns","highlightScroll","forgetLastActive","editable","autoEdit"]],"copyPaste":[[]],"copyPasteOptions":[["newRows"]],"autoColumns":[["remove"]],"toolbar":[[]],"colorjpath":[[]],"slick.defaultColumnWidth":[null],"slick.rowHeight":["80"],"slick.headerRowHeight":[30],"slick.selectionModel":["row"],"idProperty":[""],"filterType":["pref"],"filterRow":["// Documentation: https://github.com/NPellet/visualizer/blob/46b40ca86345f8fa313563bf9c6ecb80ba323101/src/modules/types/edition/slick_grid/view.js#L1695-L1735"],"customJpaths":[""]}],"cols":[[{"name":"Molfile","jpath":["molfile"],"rendererOptions":"{suppressChiralText: false, suppressESR: false, suppressCIPParity: false, noStereoProblem: false, noImplicitAtomLabelColors: true, showAtomNumber: false, showBondNumber: false, inflateToMaxAVBL: true, highlightQueryFeatures: true }","forceType":"molfile2d","width":150,"minWidth":150,"maxWidth":150,"editor":"none","formatter":"typerenderer","selectable":[],"resizable":[],"sortable":[],"focusable":[],"defaultSortAsc":[]},{"name":"label","jpath":["label"],"forceType":"string","editor":"string","formatter":"typerenderer","width":"","minWidth":"","maxWidth":"","selectable":[],"resizable":[],"sortable":[],"focusable":[],"defaultSortAsc":[]},{"name":"MF","jpath":["MF"],"forceType":"string","editor":"string","formatter":"typerenderer","width":"","minWidth":"","maxWidth":"","selectable":[],"resizable":[],"sortable":[],"focusable":[],"defaultSortAsc":[]}]],"actionCols":[[{"backgroundColor":[255,255,255,0],"color":[0,0,0,1],"position":"end","clickMode":"text"}]],"groupings":[[{"getter":[]}]],"actionOutButtons":[[{}]],"data":[{"saveInView":[[]],"varname":[""],"data":["[]"]}]}},"layers":{"Default layer":{"position":{"left":45,"top":22},"size":{"width":74,"height":50},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Admin":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"preferences":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"preferences"},"import data":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"import data"},"results":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"results"},"create":{"position":{"left":45,"top":28},"size":{"width":62,"height":50},"zIndex":0,"display":true,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"create"},"Load and Process":{"position":{"left":45,"top":22},"size":{"width":74,"height":50},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"}},"id":98,"vars_in":[{"rel":"list","name":"database"}],"actions_in":[{"rel":"_editPreferences","name":"setParameters"}],"vars_out":[{"jpath":[]}],"actions_out":[{"jpath":[]}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[[]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"","zindex":27},{"url":"modules/types/client_interaction/dragdrop/","configuration":{"sections":{},"groups":{"group":[{"label":["Drop your Molfile here"],"dragoverlabel":[null],"hoverlabel":["Drag'n drop or paste here"],"fileSelectLabel":["Select file"],"labelFontSize":[26],"checkOptions":[["promptAmbiguous"]],"inputOptions":[["allowDrop","allowPaste","allowFileInput"]]}],"vars":[[{"filter":"ext","extension":"*","filetype":"text","type":"","variable":"file"}]],"string_general":[{"askFilename":[[]]}],"string":[[{"filter":"ext","extension":"*","type":"","variable":"file"}]],"photo":[[{"variable":"photo"}]]}},"layers":{"Default layer":{"position":{"left":0,"top":62},"size":{"width":44,"height":10},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Admin":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"preferences":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"preferences"},"import data":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"import data"},"results":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"results"},"create":{"position":{"left":0,"top":68},"size":{"width":44,"height":10},"zIndex":0,"display":true,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"create"},"Load and Process":{"position":{"left":0,"top":62},"size":{"width":44,"height":10},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"}},"id":99,"vars_out":[{"event":"onRead","rel":"dataarray","jpath":[],"name":"droppedMolfiles"}],"vars_in":[],"actions_in":[{}],"actions_out":[{"jpath":[]}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[[]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"","zindex":2},{"url":"modules/types/client_interaction/button_action/","configuration":{"sections":{},"groups":{"group":[{"toggle":["click"],"label":["Add structure"],"onLabel":["Toggle action off"],"offLabel":["Toggle action on"],"title":[""],"css":["font-size: 11px;\nbackground-color: #E6E6E6;\nborder: 1px solid rgba(0, 0, 0, 0.2);\nheight: 30px;\npadding: .5em 1em;\nfont-weight: bold;"],"cssOn":["font-size: 11px;\nbackground-color: #E6E6E6;\nborder: 1px solid rgba(0, 0, 0, 0.2);\nheight: 30px;\npadding: .5em 1em;\nfont-weight: bold;"],"cssOff":["font-size: 11px;\nbackground-color: #E6E6E6;\nborder: 1px solid rgba(0, 0, 0, 0.2);\nheight: 30px;\npadding: .5em 1em;\nfont-weight: bold;"],"startState":["off"],"text":[null],"askConfirm":[[]],"confirmText":["Are you sure?"],"okLabel":["Ok"],"cancelLabel":["Cancel"],"contentType":["content"],"content":[""],"maskOpacity":[0.6]}]}},"layers":{"Default layer":{"position":{"left":34,"top":58},"size":{"width":13,"height":4},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"Default layer"},"Admin":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"preferences":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"preferences"},"import data":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"import data"},"results":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"results"},"create":{"position":{"left":34,"top":63},"size":{"width":13,"height":5},"zIndex":0,"display":true,"title":"","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"create"},"Load and Process":{"position":{"left":34,"top":58},"size":{"width":13,"height":4},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"Default layer"}},"id":100,"vars_in":[],"actions_in":[{}],"vars_out":[],"actions_out":[{"event":"onClick","rel":"actionText","jpath":[],"name":"addMolfile"}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[["Open Preferences"]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"","zindex":2},{"url":"modules/types/client_interaction/code_executor/","configuration":{"sections":{},"groups":{"group":[{"display":[["editor","buttons"]],"execOnLoad":[[]],"asyncAwait":[["top"]],"script":["const database = API.getData('database');\nconst empty = `\nActelion Java MolfileCreator 1.0\n\n  0  0  0  0  0  0  0  0  0  0999 V2000\nM  END\n`;\n\nif (this.action) {\n    switch (this.action.name) {\n        case 'addMolfile':\n            const molfile = API.getData('molfile').resurrect();\n            const idCode = OCL.Molecule.fromMolfile(molfile).getIDCode();\n            let exist = check(idCode);\n            if (molfile == empty || exist) return;\n            database.push({\n                id: idCode,\n                molfile: molfile,\n            });\n            database.triggerChange();\n            break;\n    }\n} else if (this.variable) {\n    switch (this.variable) {\n        case 'smilesList':\n            appendSmiles(API.getData('smilesList').resurrect());\n            break;\n        case 'droppedMolfiles':\n            const droppedMolfiles = API.getData('droppedMolfiles').resurrect();\n            for (let molfile of droppedMolfiles.file) {\n                const idCode = OCL.Molecule.fromMolfile(molfile.content)\n                    .getIDCode();\n                let exist = check(idCode);\n                if (molfile.content == empty || exist) return;\n                database.push({\n                    id: idCode,\n                    molfile: molfile.content,\n                    filename: molfile.filename.split('.')[0],\n                });\n            }\n            database.triggerChange();\n            break;\n    }\n}\n\nfunction appendSmiles(smiles) {\n    for (let smile of smiles.split(/[\\r\\n\\t ,;]+/)) {\n        const molecule = OCL.Molecule.fromSmiles(smile);\n        const idCode = molecule.getIDCode();\n        console.log(idCode)\n        let exist = check(idCode);\n        if (exist) return;\n        database.push({\n            id: idCode,\n            molfile: molecule.toMolfile()\n        })\n    }\n    database.triggerChange();\n}\n\nfunction check(idCode) {\n    let exist = database.find((item) => \n        item.id == idCode\n    )\n    if (exist) UI.showNotification('The current structure is already in the list', 'error')\n    return exist ? true: false;\n}\n"]}],"libs":[[{"lib":"OCL","alias":"OCL"},{"lib":"src/util/ui","alias":"UI"}]],"buttons":[[{"name":"button1","label":"Execute","hide":[],"disable":[]}]]}},"layers":{"Default layer":{"position":{"left":45,"top":63},"size":{"width":60,"height":62},"zIndex":0,"display":false,"title":"Database editor","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Admin":{"position":{"left":0,"top":89},"size":{"width":56,"height":55},"zIndex":0,"display":true,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"preferences":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"preferences"},"import data":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"import data"},"results":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"results"},"create":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"create"},"Load and Process":{"position":{"left":45,"top":63},"size":{"width":60,"height":62},"zIndex":0,"display":false,"title":"Database editor","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"}},"id":101,"vars_in":[{"rel":"inputValue","name":"droppedMolfiles"},{"rel":"inputValue","name":"smilesList"}],"actions_in":[{"rel":"execute","name":"addMolfile"}],"vars_out":[{"jpath":[]}],"actions_out":[{"jpath":[]}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[["Open Preferences"]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"","zindex":2},{"url":"modules/types/client_interaction/code_executor/","configuration":{"sections":{},"groups":{"group":[{"display":[["editor","buttons"]],"execOnLoad":[[]],"asyncAwait":[["top"]],"script":["const database = API.getData('database').resurrect()\nconst sdf = sdfCreator(database);\nif (this.action) {\n    switch(this.action.name) {\n        case 'downloadSdf': {\n            const blob = new Blob([sdf.sdf], {type: \"text/plain;charset=utf-8\"});\n            fileSaver( blob, \"dataset.sdf\");\n            break;\n        }\n        case 'saveSdf': {\n            const parserResult = SDFileParser(sdf.sdf);\n            let id = 1;\n            parserResult.molecules.forEach( (e) => {\n                e.id=id++;\n                e._highlight=id;\n            });\n            if (!parserResult.labels.includes('id')) parserResult.labels.push('id');\n            API.createData('molfiles', parserResult.molecules);\n            API.createData('keys', parserResult.labels);\n            break;\n        }\n    }\n}\n"]}],"libs":[[{"lib":"sdfCreator","alias":"sdfCreator"},{"lib":"https://www.lactame.com/lib/sdf-parser/3.1.0/sdf-parser.js","alias":"SDFileParser"},{"lib":"file-saver","alias":"fileSaver"}]],"buttons":[[{"name":"button1","label":"Execute","hide":[],"disable":[]}]]}},"layers":{"Default layer":{"position":{"left":7,"top":132},"size":{"width":57,"height":17},"zIndex":0,"display":false,"title":"Download","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Admin":{"position":{"left":57,"top":89},"size":{"width":52,"height":58},"zIndex":0,"display":true,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"preferences":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"preferences"},"import data":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"import data"},"results":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"results"},"create":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"create"},"Load and Process":{"position":{"left":7,"top":132},"size":{"width":57,"height":17},"zIndex":0,"display":false,"title":"Download","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"}},"id":102,"vars_in":[{}],"actions_in":[{"rel":"execute","name":"downloadSdf"},{"rel":"execute","name":"saveSdf"}],"vars_out":[{"jpath":[]}],"actions_out":[{"jpath":[]}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[["Open Preferences"]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"","zindex":2},{"url":"modules/types/client_interaction/code_executor/","configuration":{"sections":{},"groups":{"group":[{"display":[["editor","buttons"]],"execOnLoad":[[]],"asyncAwait":[["top"]],"script":["const parameters = API.getData('parameters').resurrect();\nconst defaults = {\n    \"name\": \"\",\n    \"jpath\": [],\n    \"editor\": \"none\",\n    \"formatter\": \"typerenderer\",\n    \"forceType\": \"\",\n    \"width\": \"\",\n    \"minWidth\": \"\",\n    \"maxWidth\": \"\",\n    \"selectable\": [],\n    \"resizable\": [],\n    \"sortable\": [],\n    \"focusable\": [],\n    \"defaultSortAsc\": []\n};\n\nfunction getColDef(options) {\n    return _.defaults(options, defaults);\n}\n\nconst setParameters = {\n    cols: [getColDef({\n        name: 'Molfile',\n        jpath: ['molfile'],\n        rendererOptions: \"{suppressChiralText: false, suppressESR: false, suppressCIPParity: false, noStereoProblem: false, noImplicitAtomLabelColors: true, showAtomNumber: false, showBondNumber: false, inflateToMaxAVBL: true, highlightQueryFeatures: true }\",\n        forceType: 'molfile2d',\n        width: 150,\n        minWidth:150,\n        maxWidth:150\n    })]\n};\n\nfor(let i = 0; i < parameters.label.length; i++) {\n    setParameters.cols.push(getColDef({\n        name: parameters.label[i],\n        jpath: [parameters.label[i]],\n        forceType: \"string\",\n        editor: \"string\"\n    }));\n}\n\nAPI.doAction('setParameters', setParameters);\n"]}],"libs":[[{}]],"buttons":[[{"name":"button1","label":"Execute","hide":[],"disable":[]}]]}},"layers":{"Default layer":{"position":{"left":18,"top":84},"size":{"width":53,"height":43},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Admin":{"position":{"left":110,"top":89},"size":{"width":26,"height":24},"zIndex":0,"display":true,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"preferences":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"preferences"},"import data":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"import data"},"results":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"results"},"create":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"create"},"Load and Process":{"position":{"left":18,"top":84},"size":{"width":53,"height":43},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"}},"id":103,"vars_in":[{"rel":"inputValue","name":"parameters"}],"actions_in":[{}],"vars_out":[{"jpath":[]}],"actions_out":[{"jpath":[]}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[["Open Preferences"]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"","zindex":2},{"url":"modules/types/client_interaction/button_action/","configuration":{"sections":{},"groups":{"group":[{"toggle":["click"],"label":["Action"],"onLabel":["Toggle action off"],"offLabel":["Toggle action on"],"title":["Download sdf file"],"css":["font-size: 11px;\nbackground-color: #E6E6E6;\nborder: 1px solid rgba(0, 0, 0, 0.2);\nheight: 30px;\npadding: .5em 1em;\nfont-weight: bold;"],"cssOn":["font-size: 11px;\nbackground-color: #E6E6E6;\nborder: 1px solid rgba(0, 0, 0, 0.2);\nheight: 30px;\npadding: .5em 1em;\nfont-weight: bold;"],"cssOff":["font-size: 11px;\nbackground-color: #E6E6E6;\nborder: 1px solid rgba(0, 0, 0, 0.2);\nheight: 30px;\npadding: .5em 1em;\nfont-weight: bold;"],"startState":["off"],"text":["downloadSdf"],"askConfirm":[[]],"confirmText":["Are you sure?"],"okLabel":["Ok"],"cancelLabel":["Cancel"],"contentType":["svg"],"content":["<svg version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\"\n\t width=\"330\" height=\"330\" viewBox=\"0 0 330 330\" xml:space=\"preserve\">\n<g id=\"XMLID_24_\">\n\t<path id=\"XMLID_25_\" d=\"M154.389,265.602c0.351,0.35,0.719,0.683,1.103,0.997c0.169,0.138,0.347,0.258,0.52,0.388\n\t\tc0.218,0.164,0.432,0.333,0.659,0.484c0.212,0.142,0.432,0.265,0.649,0.395c0.202,0.121,0.4,0.248,0.608,0.359\n\t\tc0.224,0.12,0.453,0.221,0.681,0.328c0.215,0.102,0.427,0.21,0.648,0.301c0.223,0.092,0.45,0.167,0.676,0.247\n\t\tc0.235,0.085,0.468,0.175,0.709,0.248c0.226,0.068,0.456,0.119,0.685,0.176c0.246,0.062,0.489,0.131,0.739,0.181\n\t\tc0.263,0.052,0.528,0.083,0.794,0.121c0.219,0.031,0.435,0.073,0.658,0.095c0.492,0.048,0.986,0.075,1.48,0.075\n\t\tc0.494,0,0.988-0.026,1.48-0.075c0.225-0.022,0.444-0.064,0.667-0.096c0.262-0.037,0.524-0.068,0.784-0.12\n\t\tc0.255-0.05,0.503-0.121,0.754-0.184c0.223-0.057,0.448-0.105,0.669-0.172c0.246-0.075,0.483-0.167,0.724-0.253\n\t\tc0.221-0.08,0.444-0.152,0.662-0.242c0.225-0.093,0.44-0.202,0.659-0.306c0.225-0.106,0.452-0.206,0.672-0.324\n\t\tc0.21-0.112,0.408-0.239,0.611-0.361c0.217-0.13,0.437-0.252,0.648-0.394c0.222-0.148,0.431-0.314,0.643-0.473\n\t\tc0.179-0.134,0.362-0.258,0.536-0.4c0.365-0.3,0.714-0.617,1.049-0.949c0.016-0.016,0.033-0.028,0.049-0.044l70.002-69.998\n\t\tc5.858-5.858,5.858-15.355,0-21.213c-5.857-5.858-15.355-5.857-21.213-0.001l-44.396,44.393V15c0-8.284-6.716-15-15-15\n\t\tc-8.284,0-15,6.716-15,15v203.785l-44.392-44.391c-5.858-5.858-15.356-5.858-21.213,0c-5.858,5.858-5.858,15.355,0,21.213\n\t\tL154.389,265.602z\"/>\n\t<path id=\"XMLID_26_\" d=\"M315,300H15c-8.284,0-15,6.716-15,15s6.716,15,15,15h300c8.284,0,15-6.716,15-15S323.284,300,315,300z\"/>\n</g>\n</svg>\n"],"maskOpacity":[0.6]}]}},"layers":{"Default layer":{"position":{"left":102,"top":3},"size":{"width":17,"height":21},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"Default layer"},"Admin":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"preferences":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"preferences"},"import data":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"import data"},"results":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"results"},"create":{"position":{"left":97,"top":18},"size":{"width":9,"height":12},"zIndex":0,"display":true,"title":"","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"create"},"Load and Process":{"position":{"left":102,"top":3},"size":{"width":17,"height":21},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"Default layer"}},"id":104,"vars_in":[],"actions_in":[{}],"vars_out":[],"actions_out":[{"event":"onClick","rel":"actionText","jpath":[],"name":"downloadSdf"}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[["Open Preferences"]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"","zindex":2},{"url":"modules/types/client_interaction/code_executor/","configuration":{"sections":{},"groups":{"group":[{"display":[["editor","buttons"]],"execOnLoad":[[]],"asyncAwait":[["top"]],"script":["const keys = API.getData('keys').resurrect();\n\nconst defaults = {\n    \"name\": \"\",\n    \"jpath\": [],\n    \"editor\": \"none\",\n    \"formatter\": \"typerenderer\",\n    \"forceType\": \"\",\n    \"width\": \"\",\n    \"minWidth\": \"\",\n    \"maxWidth\": \"\",\n    \"selectable\": [],\n    \"resizable\": [],\n    \"sortable\": [],\n    \"focusable\": [],\n    \"defaultSortAsc\": []\n};\n\nfunction getColDef(options) {\n    return _.defaults(options, defaults);\n}\n\nconst setParameters = {\n    cols: [getColDef({\n        name: 'Molfile',\n        jpath: ['molfile'],\n        // rendererOptions: \"{suppressChiralText: false, suppressESR: false, suppressCIPParity: false, noStereoProblem: false, noImplicitAtomLabelColors: true, showAtomNumber: false, showBondNumber: false, inflateToMaxAVBL: true, highlightQueryFeatures: true }\",\n        forceType: 'mol2d',\n        width: 150,\n        minWidth:150,\n        maxWidth:150\n    })]\n};\n\nfor(let i = 0; i < keys.length; i++) {\n    setParameters.cols.push(getColDef({\n        name: keys[i],\n        jpath: [keys[i]],\n        forceType: \"string\",\n        editor: \"string\"\n    }));\n}\n\nAPI.doAction('setLabels', setParameters);\nAPI.doAction('renderGrid');"]}],"libs":[[{}]],"buttons":[[{"name":"button1","label":"Execute","hide":[],"disable":[]}]]}},"layers":{"Default layer":{"position":{"left":0,"top":88},"size":{"width":49,"height":55},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Admin":{"position":{"left":1,"top":146},"size":{"width":55,"height":62},"zIndex":0,"display":true,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"preferences":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"preferences"},"import data":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"import data"},"results":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"results"},"create":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"create"},"Load and Process":{"position":{"left":0,"top":88},"size":{"width":49,"height":55},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"}},"id":105,"vars_in":[{"rel":"inputValue","name":"keys"}],"actions_in":[{}],"vars_out":[{"jpath":[]}],"actions_out":[{"jpath":[]}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[["Open Preferences"]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"","zindex":2},{"url":"modules/types/client_interaction/code_executor/","configuration":{"sections":{},"groups":{"group":[{"display":[["editor","buttons"]],"execOnLoad":[[]],"asyncAwait":[["top"]],"script":["let value=this.action.value;\n\nswitch (this.action.name) {\n    case 'trackClicked': {\n        if (value.event.altKey && value.event.shiftKey) {\n\n            let key=Object.keys(value.data)[0];\n            let preferences=API.getData('preferences');\n            preferences.display.correlationIndex=value.data[key].indexClosest;\n            preferences.display.correlationX=value.data[key].xExact;\n            if (! String(preferences.display.correlation)) {\n                preferences.display.correlation=\"selected\";\n                preferences.display.selection=\"none\";\n            }\n            preferences.triggerChange();\n        }\n        break;\n    }\n    case 'trackMove': {\n        let displayPreferences = API.getData('preferences').display.resurrect();\n        const trackMove = this.action.value.data.chart;\n        if (! trackMove || ! displayPreferences.trackingInfo || displayPreferences.original==='true') {\n            API.createData('trackAnnotations', []);\n            return;\n        }\n        const spectraProcessor=API.cache('spectraProcessor');\n        const annotations=spectraProcessor.getTrackAnnotation(trackMove.indexBefore)\n        API.createData('trackAnnotations', annotations)\n        break;\n    }\n    case 'downloadNormalizedMatrix':\n        const spectraProcessor = API.cache('spectraProcessor');\n        let tsv=spectraProcessor.getNormalizedText();\n        let fileSaver=await API.require('file-saver');\n        var blob = new Blob([tsv], {type: \"text/tab-separated-values;charset=utf-8\"});\n        fileSaver( blob, \"data.tsv\");\n        break;\n    default:\n}\n"]}],"libs":[[{}]],"buttons":[[{"name":"button1","label":"Execute","hide":[],"disable":[]}]]}},"layers":{"Default layer":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"Deal with other actions","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Admin":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"preferences":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"preferences"},"import data":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"import data"},"results":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"results"},"create":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"create"},"Load and Process":{"position":{"left":0,"top":0},"size":{"width":45,"height":20},"zIndex":0,"display":true,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Load and Process"}},"id":106,"vars_in":[{}],"actions_in":[{"rel":"execute","name":"downloadNormalizedMatrix"},{"rel":"execute","name":"trackMove"},{"rel":"execute","name":"trackClicked"}],"vars_out":[{"jpath":[]}],"actions_out":[{"jpath":[]}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[["Open Preferences"]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"","zindex":2},{"url":"modules/types/client_interaction/code_executor/","configuration":{"sections":{},"groups":{"group":[{"display":[["editor","buttons"]],"execOnLoad":[[]],"asyncAwait":[["top"]],"script":["const spectraInDatasetModifications = await API.require('vh/eln/sample/ml/spectraInDatasetModifications');\n\nspectraInDatasetModifications();\n\n"]}],"libs":[[{}]],"buttons":[[{"name":"button1","label":"Execute","hide":[],"disable":[]}]]}},"layers":{"Default layer":{"position":{"left":32,"top":33},"size":{"width":43,"height":40},"zIndex":0,"display":false,"title":"Monitor modifications of spectraInDataset","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Admin":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"preferences":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"preferences"},"import data":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"import data"},"results":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"results"},"create":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"create"},"Load and Process":{"position":{"left":46,"top":0},"size":{"width":44,"height":14},"zIndex":0,"display":true,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Load and Process"}},"id":107,"vars_in":[{"rel":"inputValue","name":"spectraInDataset"}],"actions_in":[{}],"vars_out":[{"jpath":[]}],"actions_out":[{"jpath":[]}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[["Open Preferences"]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"","zindex":2},{"url":"modules/types/client_interaction/code_executor/","configuration":{"sections":{},"groups":{"group":[{"display":[["editor","buttons"]],"execOnLoad":[["yes"]],"asyncAwait":[["top"]],"script":["console.log('Load and process', this.action, this.variable);\n\nconst recreateCharts = await API.require('vh/eln/sample/ml/recreateCharts');\n\nawait recreateCharts(this.variable);\n\nAPI.doAction('changedSelectedSpectra');"]}],"libs":[[{}]],"buttons":[[{"name":"button1","label":"Update data and charts","hide":[],"disable":[]}]]}},"layers":{"Default layer":{"position":{"left":111,"top":27},"size":{"width":24,"height":5},"zIndex":0,"display":false,"title":"Recreate the data and charts based on the preferences","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"Default layer"},"Admin":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"preferences":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"preferences"},"import data":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"import data"},"results":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"results"},"create":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"create"},"Load and Process":{"position":{"left":46,"top":15},"size":{"width":44,"height":20},"zIndex":0,"display":true,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Load and Process"}},"id":108,"vars_in":[{"rel":"inputValue","name":"preferences"}],"actions_in":[{"rel":"execute","name":"UpdateChart"}],"vars_out":[{"jpath":[]}],"actions_out":[{"jpath":[]}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[["Open Preferences"]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"","zindex":2},{"url":"modules/types/client_interaction/code_executor/","configuration":{"sections":{},"groups":{"group":[{"display":[["editor","buttons"]],"execOnLoad":[[]],"asyncAwait":[["top"]],"script":["console.log(this.action);\nconst roc=API.cache('roc');\n\nconst spectraDataSet=API.cache('spectraDataSet');\n\nswitch (this.action.name) {\n    case 'oplsaddSpectraToSelection': {\n        let scatterSelected=API.getData('scatterSelected').map( entry => String(entry.id));\n        let spectraInDataset=API.getData('spectraInDataset').filter( entry => scatterSelected.includes(String(entry.id)));\n        API.createData('currentlySelectedSpectra', spectraInDataset);\n        window.setTimeout( () => {\n            API.doAction('addSpectraToSelection');\n        });\n        break;\n    }\n    case 'oplsselectCurrentSpectraSelection': {\n        let scatterSelected=API.getData('scatterSelected').map( entry => String(entry.id));\n        let spectraInDataset=API.getData('spectraInDataset').filter( entry => scatterSelected.includes(String(entry.id)));\n        API.createData('currentlySelectedSpectra', spectraInDataset);\n        window.setTimeout( () => {\n            API.doAction('selectCurrentSpectraSelection');\n        });\n        break;\n    }\n    case 'oplsHideSpectra': {\n        let scatterSelected=API.getData('scatterSelected').map( entry => String(entry.id));\n        let spectraInDataset=API.getData('spectraInDataset').filter( entry => scatterSelected.includes(String(entry.id)));\n        API.createData('currentlySelectedSpectra', spectraInDataset);\n        window.setTimeout( () => {\n            API.doAction('hideSpectra');\n        });\n        break;\n    }\n    case 'clickedOPLSShape':\n        if (this.action.value.event.altKey) {\n            let spectraInDataset = API.getData('spectraInDataset');\n            let entry=spectraInDataset.filter(entry => String(entry.id) === String(this.action.value.data.info.id))[0];\n            entry.selected = DataObject.resurrect(entry.selected) ? false : true;\n            spectraInDataset.triggerChange();\n        }\n        break;\n    case 'deleteOPLSSelection': {\n\n            let spectraInDataset = API.getData('spectraInDataset');\n            let scatterSelected=API.getData('scatterSelected');\n\n            for (let selected of scatterSelected) {\n                for (let i=0; i<spectraInDataset.length; i++) {\n                    let spectrum=spectraInDataset[i];\n                    if (String(selected.id)===String(spectrum.id)) {\n                        spectraInDataset.splice(i,1);\n                        break;\n                    }\n                }\n            }\n            spectraInDataset.triggerChange();\n        }\n        break;\n    default:\n        await spectraDataSet.processAction(this.action);\n}\n\n"]}],"libs":[[{"lib":"vh/eln/Sample","alias":"Sample"},{"lib":"src/util/color","alias":"Color"},{"lib":"src/util/ui","alias":"UI"}]],"buttons":[[{"name":"button1","label":"Execute","hide":[],"disable":[]}]]}},"layers":{"Default layer":{"position":{"left":37,"top":24},"size":{"width":70,"height":32},"zIndex":0,"display":false,"title":"Deal with actions","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Admin":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"preferences":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"preferences"},"import data":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"import data"},"results":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"results"},"create":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"create"},"Load and Process":{"position":{"left":0,"top":21},"size":{"width":45,"height":45},"zIndex":0,"display":true,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Load and Process"}},"id":109,"vars_in":[{}],"actions_in":[{"rel":"execute","name":"clickedSample"},{"rel":"execute","name":"addSelectedSamples"},{"rel":"execute","name":"addSample"},{"rel":"execute","name":"addSpectrum"},{"rel":"execute","name":"refresh"},{"rel":"execute","name":"refresh"},{"rel":"execute","name":"clearSelectedSamples"},{"rel":"execute","name":"clickedOPLSShape"},{"rel":"execute","name":"deleteOPLSSelection"},{"rel":"execute","name":"addSpectraToSelection"},{"rel":"execute","name":"selectAllSpectra"},{"rel":"execute","name":"hideAllSpectra"},{"rel":"execute","name":"hideSpectra"},{"rel":"execute","name":"selectCurrentSpectraSelection"},{"rel":"execute","name":"forceRecolor"},{"rel":"execute","name":"oplsaddSpectraToSelection"},{"rel":"execute","name":"oplsselectCurrentSpectraSelection"},{"rel":"execute","name":"oplsHideSpectra"},{"rel":"execute","name":"selectCategory"},{"rel":"execute","name":"resetMinMax"}],"vars_out":[{"jpath":[]}],"actions_out":[{"jpath":[]}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[["Open Preferences"]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"","zindex":2},{"url":"modules/types/edition/slick_grid/","configuration":{"sections":{},"groups":{"group":[{"slickCheck":[["enableCellNavigation","rowNumbering","forceFitColumns","highlightScroll","editable"]],"copyPaste":[[]],"copyPasteOptions":[["newRows"]],"autoColumns":[["remove"]],"toolbar":[[]],"colorjpath":[[]],"slick.defaultColumnWidth":[null],"slick.rowHeight":[null],"slick.headerRowHeight":[30],"slick.selectionModel":["row"],"idProperty":[""],"filterType":["pref"],"filterRow":["// Documentation: https://github.com/NPellet/visualizer/blob/db85d9cc12c6204e4a3afb69bba6d695f6f8bad5/src/modules/types/edition/slick_grid/view.js#L918-L940"],"customJpaths":["jcamp.dUrl,pdf.dUrl,file.dUrl,jcamp.data,experiment,instrument"]}],"cols":[[{"name":"Identifier","jpath":["id"],"editor":"none","forceType":"","formatter":"typerenderer","copyFormatter":"default","visibility":"both","rendererOptions":"","editorOptions":"","width":143,"hideColumn":[]},{"name":"Category","jpath":["category"],"editor":"string","forceType":"","formatter":"typerenderer","copyFormatter":"default","visibility":"both","rendererOptions":"","editorOptions":"","width":123,"hideColumn":[]},{"name":"","jpath":["selected"],"editor":"boolean","forceType":"boolean","formatter":"typerenderer","copyFormatter":"default","visibility":"both","rendererOptions":"","editorOptions":"","width":39,"minWidth":"40","maxWidth":"40","hideColumn":[]},{"name":"Color","jpath":["color"],"editor":"color","forceType":"color","formatter":"typerenderer","copyFormatter":"default","visibility":"both","rendererOptions":"","editorOptions":"","width":40,"minWidth":"40","maxWidth":"40","hideColumn":[]}]],"actionCols":[[{"backgroundColor":[255,255,255,0],"color":[0,0,0,1],"position":"end","clickMode":"text"}]],"groupings":[[{"getter":[]}]],"actionOutButtons":[[{}]],"data":[{"saveInView":[[]],"varname":[""],"data":["[]"]}]}},"layers":{"Default layer":{"position":{"left":28,"top":8},"size":{"width":80,"height":24},"zIndex":0,"display":false,"title":"List of spectra in dataset","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Admin":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"List of spectra in dataset","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"preferences":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"List of spectra in dataset","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"preferences"},"import data":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"List of spectra in dataset","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"import data"},"results":{"position":{"left":0,"top":6},"size":{"width":39,"height":61},"zIndex":0,"display":true,"title":"List of spectra in dataset","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"results"},"create":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"List of spectra in dataset","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"create"},"Load and Process":{"position":{"left":91,"top":0},"size":{"width":37,"height":50},"zIndex":0,"display":true,"title":"List of spectra in dataset","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Load and Process"}},"id":110,"vars_in":[{"rel":"list","name":"spectraInDataset"}],"actions_in":[{}],"title":"List of spectra in dataset","vars_out":[{"event":"onHover","rel":"row","jpath":["toc"],"name":"tocHovered"},{"event":"onRowsSelect","rel":"rows","jpath":[],"name":"currentlySelectedSpectra"}],"actions_out":[{"event":"onHover","rel":"row","jpath":[],"name":"hoverRow"}],"zindex":36,"toolbar":{"custom":[[{"title":"Remove all spectra from dataset","icon":"fa-eraser","action":"clearSelectedSamples","position":"begin","color":[100,100,100,1]},{"title":"Select category","icon":"fa-dot-circle","action":"selectCategory","position":"begin","color":[100,100,100,1]},{"title":"Download normalized matrix","icon":"fa-download","action":"downloadNormalizedMatrix","position":"begin","color":[100,100,100,1]},{"title":"Recolor spectra based on category","icon":"fa-palette","action":"forceRecolor","position":"begin","color":[103,78,167,1]},{"title":"Select all spectra","icon":"fa-eye","action":"selectAllSpectra","position":"begin","color":[56,118,29,1]},{"title":"Append to selected spectra","icon":"fa-plus","action":"addSpectraToSelection","position":"begin","color":[56,118,29,1]},{"title":"Select only current spectra","icon":"fa-bullseye","action":"selectCurrentSpectraSelection","position":"begin","color":[180,95,6,1]},{"title":"Remove spectra from current selection","icon":"fa-minus","action":"hideSpectra","position":"begin","color":[153,0,0,1]},{"title":"Unselect all spectra","icon":"fa-eye-slash","action":"hideAllSpectra","position":"begin","color":[153,0,0,1]}]],"common":[{"toolbar":[[]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}]},{"url":"modules/types/display/template-twig/","configuration":{"sections":{},"groups":{"group":[{"selectable":[[]],"template":["<style>\n    #displayPreferences select {\n        background-color: #DDD;\n        font-size: small;\n    }\n</style>\n<div id=\"displayPreferences\">\n    Display:\n    <select name='display.selection'>\n        <option value=\"\">None</option>\n        <option value=\"selected\">Selected</option>\n        <option value=\"all\">All</option>\n    </select>\n    \n    {% if keepOriginal %}\n         \n        <select name='display.original'>\n            <option value=\"true\">Original</option>\n            <option value=\"false\">Normalized</option>\n        </select>\n    {% else %}\n        <input type='hidden' name='display.original' value='false'>\n    {% endif %}\n    \n      \n    \n    Box-plot:\n    <select name='display.boxplot'>\n        <option value=\"\">None</option>\n        <option value=\"selected\">Selected</option>\n        <option value=\"all\">All</option>\n    </select>\n        \n    <div style=\"display:none\">\n        Q2 stroke width: <input type=\"number\" step=\"any\" style=\"width:50px\" name=\"display.boxplotOptions.q2StrokeWidth\"> - color: <input type=\"color\" name=\"display.boxplotOptions.q2StrokeColor\"><br>\n        Q1/Q3 fill opacity: <input type=\"number\" step=\"any\" style=\"width:50px\" name=\"display.boxplotOptions.q13FillOpacity\"> - color: <input type=\"color\" name=\"display.boxplotOptions.q13FillColor\"><br>\n        min/max fill opacity: <input type=\"number\" step=\"any\" style=\"width:50px\" name=\"display.boxplotOptions.minMaxFillOpacity\"> - color: <input type=\"color\" name=\"display.boxplotOptions.minMaxFillColor\"><br>\n    </div>\n    \n    <label>\n        <input type=\"checkbox\" name=\"display.trackingInfo\">\n        Tracking info\n    </label>\n    \n     Correlation:\n        <select name='display.correlation'>\n            <option value=\"\">None</option>\n            <option value=\"selected\">Selected</option>\n            <option value=\"all\">All</option>\n        </select>\n        <input type=\"hidden\" name=\"display.correlationIndex\" step=\"any\" value=\"{{preferences.display.correlationIndex}}\" style=\"width: 50px\">\n            \n</div>"],"modifyInForm":[["yes"]],"debouncing":[500],"formOptions":[["keepFormValueIfDataUndefined"]]}]}},"layers":{"Default layer":{"position":{"left":62,"top":47},"size":{"width":74,"height":5},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"Default layer"},"Admin":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"preferences":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"preferences"},"import data":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"import data"},"results":{"position":{"left":47,"top":12},"size":{"width":64,"height":4},"zIndex":0,"display":true,"title":"","bgColor":[255,255,255,0],"wrapper":false,"created":true,"name":"results"},"create":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"create"},"Load and Process":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Load and Process"}},"id":111,"vars_in":[{"rel":"tpl","name":"twigPreferences"},{"rel":"form","name":"preferences"},{"rel":"value","name":"ranges"},{"rel":"value","name":"keepOriginal"},{"rel":"value","name":"preferences"}],"actions_in":[{}],"vars_out":[{"jpath":[]}],"actions_out":[{"event":"onFormChanged","rel":"form","jpath":[],"name":"changedPreferences"},{"event":"onFormSubmitted","rel":"form","jpath":[],"name":"UpdateChart"}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[["Open Preferences"]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"","zindex":36},{"url":"modules/types/science/spectra/spectra_displayer/","configuration":{"sections":{"graph":[{"sections":{},"groups":{"graph":[{"url":[""],"zoom":["x"],"wheelAction":["zoomY"],"wheelbaseline":[0],"fullOut":["xAxis"],"legend":[null],"legendOptions":[["isSerieHideable","isSerieSelectable"]],"mouseTracking":[["track"]],"trackingAxis":["x"],"selectScatter":[[]],"independantYZoom":[[]]}]}}],"axis":[{"sections":{},"groups":{"xAxis":[{"checkboxes":[["flip","main","sec","display"]],"label":[" (ppm)"],"beforeSpacing":["0"],"afterSpacing":[""],"min":[""],"max":[""],"nbTicksPrimary":[5],"axismodification":["none"]}],"yAxis":[{"checkboxes":[["main","sec"]],"label":[""],"beforeSpacing":["0"],"afterSpacing":[0],"min":[""],"max":[""],"nbTicksPrimary":[5],"fitToAxisOnFromTo":[[]]}]}}],"series":[{"sections":{},"groups":{"series":[{"overflow":[[]],"stackVerticalSpacing":[0]}]}}],"variables":[{"sections":{},"groups":{"variables":[[{"variable":"chart","axis":"0","adaptTo":"none","plotcolor":[1,1,255,1],"strokewidth":"1","strokestyle":"1","plotcontinuous":"continuous","peakpicking":[],"markers":[],"markerShape":"1","markerSize":2,"normalize":"none","optimizeSlots":[],"tracking":["yes"]},{"variable":"correlationChart","axis":"0","adaptTo":"none","plotcolor":[1,1,255,1],"strokewidth":"1","strokestyle":"1","plotcontinuous":"continuous","peakpicking":[],"markers":[],"markerShape":"1","markerSize":2,"normalize":"none","optimizeSlots":[],"tracking":["yes"]}]]}}],"misc":[{"sections":{},"groups":{"misc":[{"highlightOptions":["{height:'100%', fill: 'rgba(255,255,0,0.2)'}"]}]}}]},"groups":{}},"layers":{"Default layer":{"position":{"left":58,"top":44},"size":{"width":101,"height":38},"zIndex":0,"display":false,"title":"Create new range by pressing ALT and then click at the beginning and the end of the range. To calculate STOCSY press SHIFT + Alt and click at the point","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"admin"},"Admin":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"Create new range by pressing ALT and then click at the beginning and the end of the range. To calculate STOCSY press SHIFT + Alt and click at the point","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"preferences":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"Create new range by pressing ALT and then click at the beginning and the end of the range. To calculate STOCSY press SHIFT + Alt and click at the point","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"preferences"},"import data":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"Create new range by pressing ALT and then click at the beginning and the end of the range. To calculate STOCSY press SHIFT + Alt and click at the point","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"import data"},"results":{"position":{"left":40,"top":9},"size":{"width":86,"height":40},"zIndex":0,"display":true,"title":"Create new range by pressing ALT and then click at the beginning and the end of the range. To calculate STOCSY press SHIFT + Alt and click at the point","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"results"},"create":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"Create new range by pressing ALT and then click at the beginning and the end of the range. To calculate STOCSY press SHIFT + Alt and click at the point","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"create"},"Load and Process":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"Create new range by pressing ALT and then click at the beginning and the end of the range. To calculate STOCSY press SHIFT + Alt and click at the point","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Load and Process"}},"id":112,"vars_in":[{"rel":"annotations","name":"rangeAnnotations"},{"rel":"chart","name":"chart"},{"rel":"annotations","name":"filterAnnotations"},{"rel":"chart","name":"boxPlotChart"},{"rel":"annotations","name":"trackAnnotations"},{"rel":"chart","name":"correlationChart"},{"rel":"annotations","name":"correlationAnnotations"}],"actions_in":[{"rel":"fromToX","name":"fromToX2"}],"vars_out":[{"event":"onTrackClick","rel":"trackData","jpath":[],"name":"clickedPoint"}],"actions_out":[{"event":"onTrackClick","rel":"dataAndEvent","jpath":[],"name":"trackClicked"},{"event":"onTrackMouse","rel":"dataAndEvent","jpath":[],"name":"trackMove"},{"event":"onZoomChange","rel":"fromToX","jpath":[],"name":"fromToX"}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[[]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":"Create new range by pressing ALT and then click at the beginning and the end of the range. To calculate STOCSY press SHIFT + Alt and click at the point","zindex":1},{"url":"modules/types/client_interaction/code_executor/","configuration":{"sections":{},"groups":{"group":[{"display":[["editor","buttons"]],"execOnLoad":[[]],"asyncAwait":[["top"]],"script":["let correlation = API.getData('correlationChart').resurrect();\nconsole.log(correlation)"]}],"libs":[[{}]],"buttons":[[{"name":"button1","label":"Execute","hide":[],"disable":[]}]]}},"layers":{"Default layer":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Default layer"},"Admin":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Admin"},"preferences":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"preferences"},"import data":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"import data"},"results":{"position":{"left":6,"top":74},"size":{"width":56,"height":35},"zIndex":0,"display":true,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"results"},"create":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"create"},"Load and Process":{"position":{"left":0,"top":0},"size":{"width":20,"height":20},"zIndex":0,"display":false,"title":"","bgColor":[255,255,255,0],"wrapper":true,"created":true,"name":"Load and Process"}},"id":113,"vars_in":[{}],"actions_in":[{}],"vars_out":[{"jpath":[]}],"actions_out":[{"jpath":[]}],"toolbar":{"custom":[[{"title":"","icon":"","action":"","position":"begin","color":[100,100,100,1]}]],"common":[{"toolbar":[["Open Preferences"]]}]},"css":[{"fontSize":[""],"fontFamily":[""]}],"title":""}],"variables":[{"jpath":[""]}],"aliases":[{"path":"../../lib/ml/5.1.1/ml","alias":"ML"},{"path":"../../lib/openchemlib-extended/6.0.0/openchemlib-extended","alias":"OCLE"},{"path":"../../lib/nmr-predictor/1.2.3/nmr-predictor","alias":"nmr-predictor"},{"path":"../../lib/spectra-data/3.7.9/spectra-data","alias":"spectra-data"},{"path":"../../lib/ml-generate-dataset/HEAD/ml-generate-dataset","alias":"generateDataset"},{"path":"../../lib/jsgraph-sd-ellipse/0.0.1/jsgraph-sd-ellipse","alias":"Ellipse"},{"path":"../../lib/sdf-creator/2.0.3/sdf-creator","alias":"sdfCreator"},{"path":"../../lib/openchemlib/7.2.3/openchemlib-core","alias":"OCL"},{"path":"../../github/cheminfo-js/visualizer-helper/e84e8228dcf2ae168d6d5a85d3cb09bfe1bd7805","alias":"vh"}],"configuration":{"title":"NMR artificial dataset generator"},"actionscripts":[{"sections":{},"groups":{"action":[{"name":[null],"script":[null]}]}}],"init_script":[{"sections":{},"groups":{"general":[{"script":["const [\n    Sample,\n    SP,\n    UserAnalysisResults,\n    SpectraDataSet,\n    Toc,\n    Roc,\n] = await API.require([\n    'vh/eln/Sample',\n    'https://www.lactame.com/lib/spectra-processor/1.1.0/spectra-processor.js',\n    'vh/rest-on-couch/UserAnalysisResults',\n    'vh/eln/sample/ml/SpectraDataSet',\n    'vh/eln/Toc',\n    'vh/rest-on-couch/Roc',\n])\n\n\nconst SpectraProcessor = SP.SpectraProcessor;\nAPI.cache('spectraProcessor', new SpectraProcessor({}));\n\nif((typeof IframeBridge)!=='undefined') {\n    IframeBridge.onMessage(onMessage);\n    IframeBridge.ready();\n} else {\n    const spectraDataSet = new SpectraDataSet(undefined, undefined, {\n        defaultAttributes: {\n            oplsModel: false\n        }\n    });\n    spectraDataSet.initializeAnalysis();\n    API.cache('spectraDataSet', spectraDataSet);\n}\n\nasync function onMessage(data) {\n    if(data.type === 'tab.data') {\n        const couchDB = data.message.couchDB;\n        const uuid = data.message.uuid;\n        API.cache('couchDB', couchDB);\n        API.cache('uuid', uuid);\n        const roc = new Roc(couchDB);\n        API.cache('roc', roc);\n        const userAnalysisResults = new UserAnalysisResults(roc, data.message.uuid);\n        API.cache(\"userAnalysisResults\", userAnalysisResults);\n        userAnalysisResults.refresh();\n        API.createData('description', '');\n        \n        const sampleToc = new Toc(roc);\n        sampleToc.initializeGroupForm();\n        API.cache('sampleToc', sampleToc);\n        \n        const spectraDataSet = new SpectraDataSet(roc, sampleToc, {\n            defaultAttributes: {\n                oplsModel: false\n            }\n        });\n        spectraDataSet.initializeAnalysis({autoRefresh:false});\n        API.cache('spectraDataSet', spectraDataSet);\n    }\n}\n\nAPI.createData('spectraInDataset',[]);\n\nAPI.createData('dataset', {\n    samples: [],\n})\n\nAPI.createData('preferences', {\n    seed:22,\n    nbPoints: 1024,\n    noiseFactor: 1000,\n    nbClasses: 2,\n    normalization: {numberOfPoints: 2048},\n    export: {format: 'tsv'},\n    display: {\n        selection: 'selected',\n        original: false,\n        trackingInfo: false,\n        correlation: '',\n        correlationIndex: false,\n        boxplot: false,\n        boxplotOptions: {\n            q13FillColor : '#000',\n            q13FillOpacity : 0.3,\n            q2StrokeColor : '#000',\n            q2StrokeWidth : 3,\n            minMaxFillColor : '#000',\n            minMaxFillOpacity : 0.15\n        },\n        autorefresh: true\n    },\n    dataset: {\n        distribution: 'normal',\n        mean: {\n            min: 11,\n            max: 13\n        },\n        std: {\n            min: 1,\n            max: 2\n        }\n    }\n});\n\nAPI.createData('pcaPreferences', {\n    x: 0,\n    y: 1,\n    ellipse: {\n        display: true,\n        std: 2,\n        fillOpacity: 0.3\n    }\n})\n\nAPI.createData('database', []);\n\nAPI.createData('parameters', {\n    label: ['label', 'MF'],\n})\n// loadTwig(['org.cheminfo.sampleToc.chemical.default']);\n\n// API.require('vh/util/tips').then( Tips => {\n//     Tips.showTips();\n//     Tips.addPageHelp({iconSize:'fa-4x'});\n// });\n"]}]}}],"custom_filters":[{"sections":{"modules":[{"sections":{},"groups":{"modules":[[{}]]}}],"filtersLib":[{"sections":{},"groups":{"filters":[[{}]]}}],"filters":[{"sections":{},"groups":{"filter":[{"name":["smiles2molfile"],"script":["return {\n    filter:function filter(values, resolve) {\n        console.log(values);\n        if (values && values.smiles) {\n            resolve( OCLE.Molecule.fromSmiles(values.smiles).toMolfile());\n        }\n    }\n}"]}],"libs":[[{"lib":"OCL","alias":"OCL"}]]}}]},"groups":{}}],"actionfiles":[{"sections":{},"groups":{"action":[[{}]]}}]}